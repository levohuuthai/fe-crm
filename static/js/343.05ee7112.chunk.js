"use strict";(self.webpackChunkfe_crm=self.webpackChunkfe_crm||[]).push([[343],{49343:(e,a,t)=>{t.r(a),t.d(a,{default:()=>C});var l=t(89379),o=t(65043),i=t(60267),s=t(40405),n=t(53969),r=t(55895),d=t(29651),c=t(95220),p=t(24341),m=t(90160),u=t(63898),b=t(82518),g=t(53974),h=t(87195),y=t(74117),x=t(70579);const v=[{id:"1",name:"Tr\u1ea7n Th\u1ecb B",email:"tran.b@company.com",avatar:"/avatars/tran.jpg"},{id:"2",name:"Ph\u1ea1m V\u0103n C",email:"pham.c@company.com",avatar:"/avatars/pham.jpg"},{id:"3",name:"Nguy\u1ec5n Th\u1ecb D",email:"nguyen.d@company.com",avatar:"/avatars/nguyen.jpg"},{id:"4",name:"L\xea V\u0103n E",email:"le.e@company.com",avatar:"/avatars/le.jpg"},{id:"5",name:"Ho\xe0ng Th\u1ecb F",email:"hoang.f@company.com",avatar:"/avatars/hoang.jpg"}],f=[{value:"prospecting",label:"Prospecting",color:"#2196f3"},{value:"qualification",label:"Qualification",color:"#ff9800"},{value:"proposal",label:"Proposal",color:"#9c27b0"},{value:"negotiation",label:"Negotiation",color:"#f44336"},{value:"closed-won",label:"Closed Won",color:"#4caf50"},{value:"closed-lost",label:"Closed Lost",color:"#9e9e9e"}],w=[{value:"low",label:"Low",color:"#9e9e9e"},{value:"medium",label:"Medium",color:"#ff9800"},{value:"high",label:"High",color:"#f44336"},{value:"urgent",label:"Urgent",color:"#e91e63"}],A=[{id:"1",dealName:"H\u1ec7 th\u1ed1ng CRM cho ABC Corp",customer:"ABC Corporation",amount:5e8,stage:"proposal",priority:"high",owner:"1",probability:75,expectedCloseDate:"2024-02-15",lastActivity:"2024-01-15"},{id:"2",dealName:"Ph\u1ea7n m\u1ec1m qu\u1ea3n l\xfd kho XYZ",customer:"XYZ Trading",amount:3e8,stage:"negotiation",priority:"urgent",owner:"2",probability:85,expectedCloseDate:"2024-01-30",lastActivity:"2024-01-14"},{id:"3",dealName:"Gi\u1ea3i ph\xe1p Cloud cho Tech Solutions",customer:"Tech Solutions",amount:8e8,stage:"qualification",priority:"medium",owner:"3",probability:60,expectedCloseDate:"2024-03-20",lastActivity:"2024-01-12"},{id:"4",dealName:"App mobile cho Innovation Startup",customer:"Innovation Startup",amount:25e7,stage:"prospecting",priority:"low",owner:"1",probability:30,expectedCloseDate:"2024-04-10",lastActivity:"2024-01-10"},{id:"5",dealName:"ERP System cho Big Enterprise",customer:"Big Enterprise",amount:12e8,stage:"proposal",priority:"urgent",owner:"4",probability:70,expectedCloseDate:"2024-02-28",lastActivity:"2024-01-13"},{id:"6",dealName:"POS System cho Retail Chain",customer:"Retail Chain",amount:4e8,stage:"closed-won",priority:"high",owner:"2",probability:100,expectedCloseDate:"2024-01-20",lastActivity:"2024-01-16"},{id:"7",dealName:"Fintech Solution cho Financial Services",customer:"Financial Services",amount:6e8,stage:"negotiation",priority:"high",owner:"5",probability:80,expectedCloseDate:"2024-02-05",lastActivity:"2024-01-15"},{id:"8",dealName:"Healthcare Management System",customer:"Healthcare Group",amount:35e7,stage:"qualification",priority:"medium",owner:"3",probability:50,expectedCloseDate:"2024-03-15",lastActivity:"2024-01-11"},{id:"9",dealName:"E-commerce Platform cho Online Store",customer:"Online Store Ltd",amount:18e7,stage:"closed-lost",priority:"low",owner:"1",probability:0,expectedCloseDate:"2024-01-10",lastActivity:"2024-01-08"},{id:"10",dealName:"Digital Marketing Suite",customer:"Marketing Agency",amount:22e7,stage:"prospecting",priority:"medium",owner:"4",probability:25,expectedCloseDate:"2024-04-30",lastActivity:"2024-01-09"}],C=()=>{const e=(0,i.A)(),{t:a}=(0,y.Bd)(),t=(0,o.useMemo)(()=>[{id:"dealName",label:a("pages.deals.columns.dealName"),type:"text",width:250,sortable:!0,editable:!0,required:!0},{id:"customer",label:a("pages.deals.columns.customer"),type:"text",width:200,sortable:!0,editable:!0,required:!0},{id:"amount",label:a("pages.deals.columns.amount"),type:"currency",width:150,sortable:!0,editable:!0,required:!0,format:e=>e>=1e9?"".concat((e/1e9).toFixed(1),"B\u20ab"):e>=1e6?"".concat((e/1e6).toFixed(1),"M\u20ab"):e>=1e3?"".concat((e/1e3).toFixed(1),"K\u20ab"):"".concat(e,"\u20ab")},{id:"stage",label:a("pages.deals.columns.stage"),type:"select",width:150,sortable:!0,editable:!0,options:f},{id:"priority",label:a("pages.deals.columns.priority"),type:"select",width:120,sortable:!0,editable:!0,options:w},{id:"owner",label:a("pages.deals.columns.owner"),type:"userSelect",width:180,sortable:!0,editable:!0},{id:"probability",label:a("pages.deals.columns.probability"),type:"number",width:120,sortable:!0,editable:!0,validate:e=>{const t=Number(e);return t>=0&&t<=100?null:a("pages.deals.validation.probabilityRange")},format:e=>"".concat(e,"%")},{id:"expectedCloseDate",label:a("pages.deals.columns.expectedCloseDate"),type:"date",width:150,sortable:!0,editable:!0},{id:"lastActivity",label:a("pages.deals.columns.lastActivity"),type:"date",width:140,sortable:!0,editable:!0},{id:"actions",label:a("pages.deals.columns.actions"),type:"actions",width:100,sortable:!1,editable:!1}],[a]),[C,j]=(0,o.useState)(A),[S,D]=(0,o.useState)(A),[N,k]=(0,o.useState)(!1),[F,R]=(0,o.useState)([]),[M,B]=(0,o.useState)("all"),P=[{id:"owner",label:a("pages.deals.filters.owner"),type:"owner",icon:(0,x.jsx)(m.A,{fontSize:"small"}),enabled:!0,fieldName:"owner"},{id:"expectedCloseDate",label:a("pages.deals.filters.expectedCloseDate"),type:"date",icon:(0,x.jsx)(u.A,{fontSize:"small"}),enabled:!0,fieldName:"expectedCloseDate"},{id:"lastActivity",label:a("pages.deals.filters.lastActivity"),type:"date",icon:(0,x.jsx)(b.A,{fontSize:"small"}),enabled:!0,fieldName:"lastActivity"},{id:"amount",label:a("pages.deals.filters.amount"),type:"amount",icon:(0,x.jsx)(g.A,{fontSize:"small"}),enabled:!0,fieldName:"amount"},{id:"stage",label:a("pages.deals.filters.stage"),type:"status",icon:(0,x.jsx)(h.A,{fontSize:"small"}),enabled:!0,fieldName:"stage"}],T=[{id:"all",label:a("pages.deals.views.all"),count:A.length},{id:"my",label:a("pages.deals.views.my"),count:6},{id:"unassigned",label:a("pages.deals.views.unassigned"),count:2}],X=v.map(e=>({id:e.id,name:e.name,email:e.email,avatar:e.avatar})),H=f.map(e=>({value:e.value,label:e.label,color:e.color})),V=C.reduce((e,a)=>e+(a.amount||0),0),q=C.filter(e=>"closed-won"===e.stage),z=q.reduce((e,a)=>e+(a.amount||0),0),E=C.filter(e=>!["closed-won","closed-lost"].includes(e.stage)),W=e=>e>=1e9?"".concat((e/1e9).toFixed(1),"B\u20ab"):e>=1e6?"".concat((e/1e6).toFixed(1),"M\u20ab"):e>=1e3?"".concat((e/1e3).toFixed(1),"K\u20ab"):"".concat(e,"\u20ab");return(0,x.jsx)(s.A,{in:!0,timeout:800,children:(0,x.jsxs)(n.A,{sx:{width:"100%",height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[(0,x.jsxs)(n.A,{sx:{mb:3,flexShrink:0,px:1},children:[(0,x.jsx)(r.A,{variant:"h4",component:"h1",sx:{fontWeight:"bold",color:"text.primary",mb:1},children:a("pages.deals.title")}),(0,x.jsx)(r.A,{variant:"body1",color:"text.secondary",sx:{mb:3},children:a("pages.deals.subtitle")}),(0,x.jsxs)(n.A,{sx:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:2},children:[(0,x.jsxs)(n.A,{sx:{p:2,borderRadius:2,backgroundColor:(0,d.X4)(e.palette.primary.main,.1),border:"1px solid ".concat((0,d.X4)(e.palette.primary.main,.2))},children:[(0,x.jsx)(r.A,{variant:"body2",color:"text.secondary",children:a("pages.deals.stats.totalValue")}),(0,x.jsx)(r.A,{variant:"h6",fontWeight:"bold",color:"primary",children:W(V)})]}),(0,x.jsxs)(n.A,{sx:{p:2,borderRadius:2,backgroundColor:(0,d.X4)(e.palette.success.main,.1),border:"1px solid ".concat((0,d.X4)(e.palette.success.main,.2))},children:[(0,x.jsx)(r.A,{variant:"body2",color:"text.secondary",children:a("pages.deals.stats.won")}),(0,x.jsx)(r.A,{variant:"h6",fontWeight:"bold",color:"success.main",children:W(z)})]}),(0,x.jsxs)(n.A,{sx:{p:2,borderRadius:2,backgroundColor:(0,d.X4)(e.palette.warning.main,.1),border:"1px solid ".concat((0,d.X4)(e.palette.warning.main,.2))},children:[(0,x.jsx)(r.A,{variant:"body2",color:"text.secondary",children:a("pages.deals.stats.active")}),(0,x.jsx)(r.A,{variant:"h6",fontWeight:"bold",color:"warning.main",children:a("pages.deals.stats.activeDeals",{count:E.length})})]}),(0,x.jsxs)(n.A,{sx:{p:2,borderRadius:2,backgroundColor:(0,d.X4)(e.palette.info.main,.1),border:"1px solid ".concat((0,d.X4)(e.palette.info.main,.2))},children:[(0,x.jsx)(r.A,{variant:"body2",color:"text.secondary",children:a("pages.deals.stats.winRate")}),(0,x.jsxs)(r.A,{variant:"h6",fontWeight:"bold",color:"info.main",children:[C.length>0?Math.round(q.length/C.length*100):0,"%"]})]})]})]}),(0,x.jsx)(p.A,{entity:"deals",availableFilters:P,owners:X,statuses:H,savedViews:T,currency:"\u20ab",onQueryChange:e=>{var a,t;let l=[...C];if(e.ownerIds.length>0&&(l=l.filter(a=>e.ownerIds.includes(a.owner)||e.ownerIds.includes("unassigned")&&!a.owner)),e.leadStatus.length>0&&(l=l.filter(a=>e.leadStatus.includes(a.stage))),e.amount){const{min:a,max:t}=e.amount;l=l.filter(e=>{const l=e.amount||0;return a&&t?l>=a&&l<=t:a?l>=a:!t||l<=t})}null!==(a=e.expectedCloseDate)&&void 0!==a&&a.preset&&console.log("Filtering by expected close date:",e.expectedCloseDate.preset),null!==(t=e.lastActivity)&&void 0!==t&&t.preset&&console.log("Filtering by last activity:",e.lastActivity.preset),D(l)},onViewChange:e=>{B(e);let a=[...C];switch(e){case"my":a=a.filter(e=>"1"===e.owner);break;case"unassigned":a=a.filter(e=>!e.owner);break;default:a=C}D(a)},sticky:!0}),(0,x.jsx)(n.A,{sx:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},children:(0,x.jsx)(c.A,{columns:t,data:S,loading:N,searchable:!0,filterable:!1,selectable:!0,pagination:!0,defaultRowsPerPage:25,onRowSelect:R,onCellEdit:async(e,a,t)=>(k(!0),await new Promise(e=>setTimeout(e,1e3)),j(o=>o.map(o=>o.id===e?(0,l.A)((0,l.A)({},o),{},{[a]:t}):o)),D(o=>o.map(o=>o.id===e?(0,l.A)((0,l.A)({},o),{},{[a]:t}):o)),k(!1),!0),onRowDoubleClick:e=>{console.log("Open deal detail:",e)},onBulkAction:(e,a)=>{if(console.log("Bulk action:",e,a),"delete"===e)j(e=>e.filter(e=>!a.includes(e.id))),R([])},users:v,emptyMessage:a("pages.deals.empty"),zebra:!0})})]})})}},63898:(e,a,t)=>{t.d(a,{A:()=>i});var l=t(14057),o=t(70579);const i=(0,l.A)((0,o.jsx)("path",{d:"M20 3h-1V1h-2v2H7V1H5v2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m0 18H4V8h16z"}),"CalendarToday")}}]);
//# sourceMappingURL=343.05ee7112.chunk.js.map