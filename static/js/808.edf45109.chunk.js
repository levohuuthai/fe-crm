"use strict";(self.webpackChunkfe_crm=self.webpackChunkfe_crm||[]).push([[808],{4573:(e,t,n)=>{n.d(t,{A:()=>s});var a=n(14057),i=n(70579);const s=(0,a.A)((0,i.jsx)("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 4-8 5-8-5V6l8 5 8-5z"}),"Email")},51692:(e,t,n)=>{n.d(t,{A:()=>j});var a=n(89379),i=n(80045),s=n(65043),o=n(58387),l=n(31807),r=n(83392),d=n(58128),c=n(28301),u=n(79857),p=n(86061);function m(e){return(0,p.Ay)("MuiTableFooter",e)}(0,u.A)("MuiTableFooter",["root"]);var h=n(70579);const x=["className","component"],g=(0,d.Ay)("tfoot",{name:"MuiTableFooter",slot:"Root"})({display:"table-footer-group"}),A={variant:"footer"},f="tfoot",j=s.forwardRef(function(e,t){const n=(0,c.b)({props:e,name:"MuiTableFooter"}),{className:s,component:d=f}=n,u=(0,i.A)(n,x),p=(0,a.A)((0,a.A)({},n),{},{component:d}),j=(e=>{const{classes:t}=e;return(0,l.A)({root:["root"]},m,t)})(p);return(0,h.jsx)(r.A.Provider,{value:A,children:(0,h.jsx)(g,(0,a.A)({as:d,className:(0,o.A)(j.root,s),ref:t,role:d===f?null:"rowgroup",ownerState:p},u))})})},70298:(e,t,n)=>{n.d(t,{A:()=>k});var a=n(80045),i=n(89379),s=n(65043),o=n(58387),l=n(53129),r=n(86061),d=n(31807),c=n(70883),u=n(94943),p=n(85227),m=n(79049),h=n(16167),x=n(71834),g=n(70579);const A=["component","direction","spacing","divider","children","className","useFlexGap"],f=(0,m.A)(),j=(0,c.A)("div",{name:"MuiStack",slot:"Root"});function b(e){return(0,u.A)({props:e,name:"MuiStack",defaultTheme:f})}function v(e,t){const n=s.Children.toArray(e).filter(Boolean);return n.reduce((e,a,i)=>(e.push(a),i<n.length-1&&e.push(s.cloneElement(t,{key:"separator-".concat(i)})),e),[])}const y=e=>{let{ownerState:t,theme:n}=e,a=(0,i.A)({display:"flex",flexDirection:"column"},(0,h.NI)({theme:n},(0,h.kW)({values:t.direction,breakpoints:n.breakpoints.values}),e=>({flexDirection:e})));if(t.spacing){const e=(0,x.LX)(n),i=Object.keys(n.breakpoints.values).reduce((e,n)=>(("object"===typeof t.spacing&&null!=t.spacing[n]||"object"===typeof t.direction&&null!=t.direction[n])&&(e[n]=!0),e),{}),s=(0,h.kW)({values:t.direction,base:i}),o=(0,h.kW)({values:t.spacing,base:i});"object"===typeof s&&Object.keys(s).forEach((e,t,n)=>{if(!s[e]){const a=t>0?s[n[t-1]]:"column";s[e]=a}});const r=(n,a)=>{return t.useFlexGap?{gap:(0,x._W)(e,n)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{["margin".concat((i=a?s[a]:t.direction,{row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"}[i]))]:(0,x._W)(e,n)}};var i};a=(0,l.A)(a,(0,h.NI)({theme:n},o,r))}return a=(0,h.iZ)(n.breakpoints,a),a};var q=n(58128),w=n(28301);const C=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{createStyledComponent:t=j,useThemeProps:n=b,componentName:l="MuiStack"}=e,c=t(y),u=s.forwardRef(function(e,t){const s=n(e),u=(0,p.A)(s),{component:m="div",direction:h="column",spacing:x=0,divider:f,children:j,className:b,useFlexGap:y=!1}=u,q=(0,a.A)(u,A),w={direction:h,spacing:x,useFlexGap:y},C=(0,d.A)({root:["root"]},e=>(0,r.Ay)(l,e),{});return(0,g.jsx)(c,(0,i.A)((0,i.A)({as:m,ownerState:w,ref:t,className:(0,o.A)(C.root,b)},q),{},{children:f?v(j,f):j}))});return u}({createStyledComponent:(0,q.Ay)("div",{name:"MuiStack",slot:"Root"}),useThemeProps:e=>(0,w.b)({props:e,name:"MuiStack"})}),k=C},70883:(e,t,n)=>{n.d(t,{A:()=>a});const a=(0,n(37675).Ay)()},87808:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Ee});var a=n(89379),i=n(65043),s=n(74117),o=n(53969),l=n(55895),r=n(41859),d=n(14333),c=n(12843),u=n(94799),p=n(70298),m=n(24343),h=n(17060),x=n(10256),g=n(3353),A=n(67203),f=n(47471),j=n(22950),b=n(63745),v=n(50103),y=n(38517),q=n(81911),w=n(78776),C=n(53407),k=n(79693),I=n(99147),S=n(22947),D=n(28259),N=n(87443),T=n(10756),z=n(86172),E=n(81341),P=n(34375),W=n(85877),M=n(47951),F=n(14057),U=n(70579);const B=(0,F.A)((0,U.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext");var R=n(22672),V=n(43971),H=n(46261),O=n(1725),_=n(68826),L=n(94527),G=n(32911),Q=n(91449),X=n(80045),Y=n(59526),J=n(42579),K=n(26529),Z=n(51692),$=n(89174);const ee=(0,F.A)((0,U.jsx)("path",{d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2m-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"}),"DragIndicator"),te=(0,F.A)((0,U.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}),"Cancel");var ne=n(61773),ae=n(5362);const ie=[{name:"Feature",isFixed:!0},{name:"Detail",isFixed:!0},{name:"Description",isFixed:!0},{name:"Notes",isFixed:!0},{name:"IT Req",isFixed:!0,isEffort:!0},{name:"UX/UI",isFixed:!0,isEffort:!0}],se=e=>{let{rows:t=[],effortColumns:n=[],onRowsChange:d,onColumnsChange:c}=e;const{t:p}=(0,s.Bd)(),[h,x]=(0,i.useState)(0),[g,A]=(0,i.useState)(10),[f,b]=(0,i.useState)(""),[v,y]=(0,i.useState)(null),[q,w]=(0,i.useState)(""),C=(e,n,i)=>{const s=t.map(t=>t.id===e?n.startsWith("effort-")?(0,a.A)((0,a.A)({},t),{},{efforts:(0,a.A)((0,a.A)({},t.efforts),{},{[n]:Number(i)||0})}):(0,a.A)((0,a.A)({},t),{},{[n]:i}):t);d(s)},k=ie.map((e,t)=>(0,a.A)((0,a.A)({},e),{},{id:"fixed-".concat(t),key:e.name.toLowerCase().replace(/\s+/g,"-"),order:t})),I=n.filter(e=>!k.some(t=>t.key===e.key)),S={id:"subtotal-column",name:p("pages.quotations.estimation.fixed.subtotalDays"),key:"subtotal",order:950,isFixed:!0},W=[...k,...I,S].sort((e,t)=>e.order-t.order);return(0,U.jsxs)(o.A,{children:[(0,U.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[(0,U.jsx)(o.A,{children:(0,U.jsx)(r.A,{variant:"contained",color:"primary",startIcon:(0,U.jsx)(j.A,{}),onClick:()=>{const e={id:"row-".concat(Date.now()),feature:"",detail:"",description:"",notes:"",itReq:"",uxUi:"",efforts:{}};d([...t,e])},size:"small",sx:{mr:1},children:p("pages.quotations.estimation.fixed.addRow")})}),(0,U.jsxs)(o.A,{sx:{display:"flex",alignItems:"center"},children:[(0,U.jsx)(m.A,{size:"small",placeholder:p("pages.quotations.estimation.fixed.newColumnPlaceholder"),value:f,onChange:e=>b(e.target.value),sx:{mr:1,minWidth:150}}),(0,U.jsx)(r.A,{variant:"outlined",startIcon:(0,U.jsx)(j.A,{}),onClick:()=>{if(!f.trim())return;const e={id:"col-".concat(Date.now()),name:f.trim(),key:"effort-".concat(Date.now()),order:900,isFixed:!1,color:"#ffffff"};c([...n,e]),b("")},size:"small",disabled:!f.trim(),children:p("pages.quotations.estimation.fixed.addColumn")})]})]}),(0,U.jsx)(D.A,{component:u.A,sx:{maxHeight:600,overflow:"auto"},children:(0,U.jsxs)(N.A,{stickyHeader:!0,size:"small",children:[(0,U.jsx)(T.A,{children:(0,U.jsxs)(z.A,{children:[(0,U.jsx)(E.A,{width:50,children:"#"}),W.map(e=>(0,U.jsx)(E.A,{children:(0,U.jsxs)(o.A,{sx:{display:"flex",alignItems:"center"},children:[(0,U.jsx)(ee,{sx:{mr:1,cursor:"move",opacity:e.isFixed?.3:1,"&:hover":{opacity:1}}}),v===e.id?(0,U.jsxs)(o.A,{sx:{display:"flex",alignItems:"center"},children:[(0,U.jsx)(m.A,{value:q,onChange:e=>w(e.target.value),size:"small",sx:{mr:1}}),(0,U.jsx)(J.A,{size:"small",onClick:()=>(e=>{const t=n.map(t=>t.id===e?(0,a.A)((0,a.A)({},t),{},{name:q}):t);c(t),y(null)})(e.id),color:"primary",children:(0,U.jsx)(R.A,{fontSize:"small"})}),(0,U.jsx)(J.A,{size:"small",onClick:()=>y(null),color:"error",children:(0,U.jsx)(te,{fontSize:"small"})})]}):(0,U.jsxs)(o.A,{sx:{display:"flex",alignItems:"center"},children:[(0,U.jsx)(l.A,{variant:"subtitle2",children:(()=>{switch(e.key){case"feature":return p("pages.quotations.estimation.table.feature");case"detail":return p("pages.quotations.estimation.table.detail");case"description":return p("pages.quotations.estimation.table.description");case"notes":return p("pages.quotations.estimation.table.note");case"it-req":return p("pages.quotations.estimation.fixed.columns.itReq");case"ux/ui":return p("pages.quotations.estimation.fixed.columns.uxUi");case"subtotal":return p("pages.quotations.estimation.fixed.subtotalDays");default:return e.name}})()}),!e.isFixed&&(0,U.jsxs)(o.A,{sx:{ml:1},children:[(0,U.jsx)(J.A,{size:"small",onClick:()=>{return t=e.id,n=e.name,y(t),void w(n);var t,n},sx:{p:.5},children:(0,U.jsx)(ne.A,{fontSize:"small"})}),(0,U.jsx)(J.A,{size:"small",onClick:()=>(e=>{const i=n.find(t=>t.id===e);if(null===i||void 0===i||!i.isFixed){const s=n.filter(t=>t.id!==e);c(s);const o=t.map(e=>{const t=e.efforts||{},n=(null===i||void 0===i?void 0:i.key)||"",{[n]:s}=t,o=(0,X.A)(t,[n].map(Y.A));return(0,a.A)((0,a.A)({},e),{},{efforts:o})});d(o)}})(e.id),sx:{p:.5},color:"error",children:(0,U.jsx)(ae.A,{fontSize:"small"})})]})]})]})},e.id)),(0,U.jsx)(E.A,{width:80,children:p("pages.quotations.tables.actions")})]})}),(0,U.jsx)(P.A,{children:t.slice(h*g,h*g+g).map((e,n)=>(0,U.jsxs)(z.A,{hover:!0,children:[(0,U.jsx)(E.A,{children:h*g+n+1}),W.map(t=>{var n;const a="it-req"===t.key||"ux/ui"===t.key||t.key.startsWith("effort-")||!0===t.isEffort;console.log("Column key:",t.key,"isEffort:",a);const i="subtotal"===t.key;return(0,U.jsx)(E.A,{children:a?(0,U.jsx)(m.A,{type:"number",value:"it-req"===t.key?e.itReq||"":"ux/ui"===t.key?e.uxUi||"":(null===(n=e.efforts)||void 0===n?void 0:n[t.key])||"",onChange:n=>{const a=n.target.value;"it-req"===t.key?C(e.id,"itReq",a):"ux/ui"===t.key?C(e.id,"uxUi",a):C(e.id,t.key,a)},size:"small",fullWidth:!0,inputProps:{min:0,step:.5}}):i?(0,U.jsx)(l.A,{variant:"body2",fontWeight:"bold",children:Object.keys(e.efforts||{}).reduce((t,n)=>{var a;return t+(Number(null===(a=e.efforts)||void 0===a?void 0:a[n])||0)},0)+(Number(e.itReq)||0)+(Number(e.uxUi)||0)}):(0,U.jsx)(m.A,{value:e[t.key]||"",onChange:n=>C(e.id,t.key,n.target.value),size:"small",fullWidth:!0,multiline:!0,maxRows:4})},"".concat(e.id,"-").concat(t.key))}),(0,U.jsx)(E.A,{children:(0,U.jsx)(K.A,{title:p("pages.quotations.estimation.fixed.deleteRow"),children:(0,U.jsx)(J.A,{size:"small",color:"error",onClick:()=>{return n=e.id,void d(t.filter(e=>e.id!==n));var n},children:(0,U.jsx)(ae.A,{fontSize:"small"})})})})]},e.id))}),(0,U.jsxs)(Z.A,{children:[(0,U.jsxs)(z.A,{children:[(0,U.jsx)(E.A,{colSpan:ie.length+1,align:"right",children:(0,U.jsx)("strong",{children:p("pages.quotations.estimation.fixed.total")})}),n.map(e=>{return(0,U.jsx)(E.A,{children:(0,U.jsx)("strong",{children:(n=e.key,t.reduce((e,t)=>{var a;return e+(Number(null===(a=t.efforts)||void 0===a?void 0:a[n])||0)},0))})},"total-".concat(e.key));var n}),(0,U.jsx)(E.A,{children:(0,U.jsx)("strong",{children:t.reduce((e,t)=>e+(Object.keys(t.efforts||{}).reduce((e,n)=>{var a;return e+(Number(null===(a=t.efforts)||void 0===a?void 0:a[n])||0)},0)+(Number(t.itReq)||0)+(Number(t.uxUi)||0)),0)})}),(0,U.jsx)(E.A,{})]}),(0,U.jsxs)(z.A,{sx:{backgroundColor:"#f5f5f5"},children:[(0,U.jsx)(E.A,{colSpan:ie.length+n.length+1,align:"right",children:(0,U.jsx)("strong",{children:p("pages.quotations.estimation.fixed.totalByPhase")})}),(0,U.jsx)(E.A,{children:(0,U.jsx)("strong",{children:t.reduce((e,t)=>e+(Object.keys(t.efforts||{}).reduce((e,n)=>{var a;return e+(Number(null===(a=t.efforts)||void 0===a?void 0:a[n])||0)},0)+(Number(t.itReq)||0)+(Number(t.uxUi)||0)),0)})}),(0,U.jsx)(E.A,{})]})]})]})}),(0,U.jsx)($.A,{rowsPerPageOptions:[5,10,25,50],component:"div",count:t.length,rowsPerPage:g,page:h,onPageChange:(e,t)=>{x(t)},onRowsPerPageChange:e=>{A(parseInt(e.target.value,10)),x(0)},labelRowsPerPage:p("pages.quotations.pagination.rowsPerPage"),labelDisplayedRows:e=>{let{from:t,to:n,count:a}=e;return p("pages.quotations.pagination.displayedRows",{from:t,to:n,count:a})}})]})},oe=["Project Manager","Business Analyst","Developer","Tester","UI/UX Designer","DevOps","System Architect","Technical Lead"],le=e=>{let{rates:t=[],onRatesChange:n}=e;const{t:d}=(0,s.Bd)(),[c,p]=(0,i.useState)(0),[h,b]=(0,i.useState)(10),[v,y]=(0,i.useState)(""),[q,w]=(0,i.useState)(""),C=(e,i,s)=>{const o=t.map(t=>t.id===e?(0,a.A)((0,a.A)({},t),{},{[i]:s}):t);n(o)},k=()=>t.reduce((e,t)=>{const n="hour"===t.unit?1:8;return e+(t.rate||0)*n},0);return(0,U.jsxs)(o.A,{children:[(0,U.jsx)(o.A,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:(0,U.jsxs)(o.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,U.jsxs)(x.A,{variant:"outlined",size:"small",sx:{minWidth:200},children:[(0,U.jsx)(g.A,{children:d("pages.quotations.tnm.selectRole")}),(0,U.jsxs)(A.A,{value:v,onChange:e=>y(e.target.value),label:d("pages.quotations.tnm.selectRole"),children:[(0,U.jsx)(f.A,{value:"",children:(0,U.jsx)("em",{children:d("pages.quotations.tnm.selectRole")})}),oe.map(e=>(0,U.jsx)(f.A,{value:e,children:e},e)),(0,U.jsx)(f.A,{value:"custom",children:(0,U.jsx)("em",{children:d("pages.quotations.tnm.addCustomRole")})})]})]}),"custom"===v&&(0,U.jsx)(m.A,{size:"small",label:d("pages.quotations.tnm.roleName"),value:q,onChange:e=>w(e.target.value),sx:{minWidth:200}}),(0,U.jsx)(r.A,{variant:"contained",color:"primary",startIcon:(0,U.jsx)(j.A,{}),onClick:()=>{if(!v&&!q)return;const e="custom"===v?q:v;if(t.some(t=>t.role.toLowerCase()===e.toLowerCase()))return void alert(d("pages.quotations.tnm.messages.roleExists"));const a={id:"rate-".concat(Date.now()),role:e,rate:0,unit:"hour",description:""};n([...t,a]),y(""),w("")},disabled:!v||"custom"===v&&!q.trim(),children:d("common.add")})]})}),(0,U.jsx)(D.A,{component:u.A,children:(0,U.jsxs)(N.A,{size:"small",children:[(0,U.jsx)(T.A,{children:(0,U.jsxs)(z.A,{children:[(0,U.jsx)(E.A,{width:50,children:d("pages.quotations.preview.table.no")}),(0,U.jsx)(E.A,{children:d("pages.quotations.tnm.columns.role")}),(0,U.jsx)(E.A,{align:"right",children:d("pages.quotations.tnm.columns.hoursOrMd")}),(0,U.jsx)(E.A,{children:d("pages.quotations.tnm.columns.unit")}),(0,U.jsx)(E.A,{align:"right",children:d("pages.quotations.tnm.columns.unitPrice")}),(0,U.jsx)(E.A,{align:"right",children:d("pages.quotations.tnm.columns.amount")}),(0,U.jsx)(E.A,{width:80})]})}),(0,U.jsx)(P.A,{children:t.slice(c*h,c*h+h).map((e,a)=>(0,U.jsxs)(z.A,{hover:!0,children:[(0,U.jsx)(E.A,{children:c*h+a+1}),(0,U.jsx)(E.A,{children:(0,U.jsx)(m.A,{value:e.role,onChange:t=>C(e.id,"role",t.target.value),size:"small",fullWidth:!0})}),(0,U.jsx)(E.A,{children:(0,U.jsx)(m.A,{type:"number",value:e.rate||"",onChange:t=>C(e.id,"rate",Number(t.target.value)),size:"small",fullWidth:!0,inputProps:{min:0,step:.01}})}),(0,U.jsx)(E.A,{children:(0,U.jsxs)(A.A,{value:e.unit,onChange:t=>C(e.id,"unit",t.target.value),size:"small",fullWidth:!0,children:[(0,U.jsx)(f.A,{value:"hour",children:d("pages.quotations.tnm.units.hour")}),(0,U.jsx)(f.A,{value:"day",children:d("pages.quotations.tnm.units.day")})]})}),(0,U.jsxs)(E.A,{align:"right",children:[new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e.rate||0),(0,U.jsxs)(l.A,{variant:"caption",display:"block",color:"text.secondary",children:["/","hour"===e.unit?d("pages.quotations.tnm.perHour"):d("pages.quotations.tnm.perMd")]})]}),(0,U.jsxs)(E.A,{align:"right",children:[new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e.rate*("hour"===e.unit?1:8)||0),(0,U.jsxs)(l.A,{variant:"caption",display:"block",color:"text.secondary",children:["(","hour"===e.unit?d("pages.quotations.tnm.hourHint"):d("pages.quotations.tnm.mdHint"),")"]})]}),(0,U.jsx)(E.A,{align:"center",children:(0,U.jsx)(K.A,{title:d("common.delete"),children:(0,U.jsx)(J.A,{size:"small",color:"error",onClick:()=>{return a=e.id,void n(t.filter(e=>e.id!==a));var a},children:(0,U.jsx)(ae.A,{fontSize:"small"})})})})]},e.id))}),(0,U.jsx)(Z.A,{children:(0,U.jsxs)(z.A,{children:[(0,U.jsx)(E.A,{colSpan:4,align:"right",children:(0,U.jsxs)("strong",{children:[d("pages.quotations.tnm.total"),":"]})}),(0,U.jsx)(E.A,{align:"right",children:(0,U.jsx)("strong",{children:new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(t.reduce((e,t)=>e+(t.rate||0),0))})}),(0,U.jsxs)(E.A,{align:"right",children:[(0,U.jsx)("strong",{children:new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(k())}),(0,U.jsxs)(l.A,{variant:"caption",display:"block",color:"text.secondary",children:["(",d("pages.quotations.tnm.totalHours",{hours:k()}),")"]})]}),(0,U.jsx)(E.A,{})]})})]})}),(0,U.jsx)($.A,{rowsPerPageOptions:[5,10,25,50],component:"div",count:t.length,rowsPerPage:h,page:c,onPageChange:(e,t)=>{p(t)},onRowsPerPageChange:e=>{b(parseInt(e.target.value,10)),p(0)},labelRowsPerPage:d("pages.quotations.pagination.rowsPerPage"),labelDisplayedRows:e=>{let{from:t,to:n,count:a}=e;return d("pages.quotations.pagination.displayedRows",{from:t,to:n,count:a})}})]})},re=[],de=[{id:"rate-1",role:"Developer",rate:50,unit:"hour",description:"Senior Developer"},{id:"rate-2",role:"Designer",rate:40,unit:"hour",description:"UI/UX Designer"}],ce=e=>{let{mode:t,onModeChange:n,onEstimationDataChange:s,initialData:r}=e;const[d,c]=(0,i.useState)([]),[p,m]=(0,i.useState)(re),[h,g]=(0,i.useState)(de),[A,f]=(0,i.useState)({open:!1,message:"",severity:"success"});(0,i.useEffect)(()=>{if(null!==r&&void 0!==r&&r.rows&&r.rows.length>0&&0===d.length){const e=r.rows.map(e=>({id:"row-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,5)),feature:e.feature||"",detail:e.detail||"",description:e.description||"",notes:e.note||"",itReq:"",uxUi:"",efforts:{}}));c(e)}else 0===d.length&&c([j()])},[d.length,r]);const j=()=>({id:"row-".concat(Date.now()),feature:"",detail:"",description:"",notes:"",itReq:"",uxUi:"",efforts:{}}),b=(e,t)=>{c(e),m(t),s&&s({mode:"fixed",rows:e,columns:t})},v=()=>{f((0,a.A)((0,a.A)({},A),{},{open:!1}))};return(0,U.jsxs)(o.A,{sx:{mt:3},children:[(0,U.jsx)(l.A,{variant:"h6",gutterBottom:!0,children:"B\u1ea3ng \u01b0\u1edbc t\xednh"}),(0,U.jsx)(u.A,{elevation:0,sx:{p:3,mb:3,border:"1px solid #e0e0e0",borderRadius:1},children:(0,U.jsxs)(x.A,{component:"fieldset",fullWidth:!0,children:[(0,U.jsx)(V.A,{component:"legend",sx:{mb:2,fontWeight:"bold",color:"text.primary"},children:"Ch\u1ecdn ph\u01b0\u01a1ng th\u1ee9c \u01b0\u1edbc t\xednh"}),(0,U.jsxs)(H.A,{row:!0,"aria-label":"estimation-mode",name:"estimation-mode",value:t,onChange:e=>{const t=e.target.value;n(t),f({open:!0,message:"\u0110\xe3 chuy\u1ec3n sang ch\u1ebf \u0111\u1ed9 ".concat("fixed"===t?"Fix Price":"Time & Material"),severity:"info"})},children:[(0,U.jsx)(O.A,{value:"fixed",control:(0,U.jsx)(_.A,{color:"primary"}),label:"Fix Price",sx:{mr:4,"& .MuiFormControlLabel-label":{fontWeight:500}}}),(0,U.jsx)(O.A,{value:"timeAndMaterial",control:(0,U.jsx)(_.A,{color:"primary"}),label:"Time & Material",sx:{"& .MuiFormControlLabel-label":{fontWeight:500}}})]}),(0,U.jsx)(L.A,{sx:{my:2}}),(0,U.jsx)(l.A,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"fixed"===t?"Ch\u1ebf \u0111\u1ed9 Fix Price: T\u1ea1o b\u1ea3ng \u01b0\u1edbc t\xednh chi ti\u1ebft v\u1edbi c\xe1c c\u1ed9t effort t\xf9y ch\u1ec9nh.":"Ch\u1ebf \u0111\u1ed9 Time & Material: T\u1ea1o b\u1ea3ng \u01b0\u1edbc t\xednh d\u1ef1a tr\xean s\u1ed1 gi\u1edd v\xe0 \u0111\u01a1n gi\xe1."})]})}),"fixed"===t?(0,U.jsx)(se,{rows:d,effortColumns:p,onRowsChange:e=>b(e,p),onColumnsChange:e=>b(d,e)}):(0,U.jsx)(le,{rates:h,onRatesChange:e=>{g(e),s&&s({mode:"timeAndMaterial",rates:e})}}),(0,U.jsx)(G.A,{open:A.open,autoHideDuration:3e3,onClose:v,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,U.jsx)(Q.A,{onClose:v,severity:A.severity,children:A.message})})]})},ue=e=>{var t;let{open:n,onClose:d,onSave:c,customers:p,deals:j,requirements:b,templates:v}=e;const{t:F}=(0,s.Bd)(),[V,H]=(0,i.useState)(0),[O,_]=(0,i.useState)({}),[L,G]=(0,i.useState)("fixed"),[Q,X]=(0,i.useState)({name:"",customer:"",dealId:0,dealName:"",requirementId:0,requirementName:"",status:"draft",createdDate:(new Date).toISOString().split("T")[0],note:"",items:[],totalEffort:0,totalAmount:0,templateId:"",templateName:"",estimationMode:"fixed"});(0,i.useEffect)(()=>{n&&_({})},[n]);const[Y,J]=(0,i.useState)(j),[K,Z]=(0,i.useState)(b),[$,ee]=(0,i.useState)([]);(0,i.useEffect)(()=>{Q.customer?J(j.filter(e=>e.customer===Q.customer)):J(j)},[Q.customer,j]),(0,i.useEffect)(()=>{Q.dealId?Z(b.filter(e=>e.dealId===Q.dealId)):Z(b)},[Q.dealId,b]),(0,i.useEffect)(()=>{if(Q.requirementId){const e=b.find(e=>e.id===Q.requirementId);if(e&&e.features&&e.features.length>0){console.log("Requirement features found:",e.features);const t=e.features.map((e,t)=>({id:t+1,feature:e.feature||"",detail:e.detail||"",description:e.description||"",note:e.notes||e.note||"",frontendEffort:0,backendEffort:0,qcEffort:0,pmEffort:0,totalMD:0,totalMM:0}));ee(t)}else console.log("No features found for requirement ID:",Q.requirementId),ee([])}else ee([])},[Q.requirementId,b]);const te=e=>{ee(e);const t=e.reduce((e,t)=>e+t.totalMD,0),n=5e5*t;X((0,a.A)((0,a.A)({},Q),{},{totalEffort:t,totalAmount:n}))},ne=[F("pages.quotations.steps.basicInfo"),F("pages.quotations.estimation.chooseMethod"),F("pages.quotations.steps.preview")];return(0,U.jsxs)(y.A,{open:n,onClose:d,maxWidth:"lg",fullWidth:!0,children:[(0,U.jsx)(q.A,{children:F("pages.quotations.dialogs.createTitle")}),(0,U.jsxs)(w.A,{children:[(0,U.jsx)(C.A,{activeStep:V,sx:{pt:3,pb:5},children:ne.map(e=>(0,U.jsx)(k.A,{children:(0,U.jsx)(I.A,{children:e})},e))}),0===V&&(0,U.jsxs)(o.A,{children:[(0,U.jsx)(l.A,{variant:"h6",gutterBottom:!0,children:F("pages.quotations.steps.basicInfo")}),(0,U.jsxs)(o.A,{sx:{mb:3,border:"1px solid #e0e0e0",borderRadius:1,p:2,bgcolor:"#f9f9f9"},children:[(0,U.jsxs)(l.A,{variant:"subtitle2",gutterBottom:!0,sx:{display:"flex",alignItems:"center"},children:[(0,U.jsx)(M.A,{fontSize:"small",sx:{mr:1}}),F("pages.quotations.fields.template")]}),(0,U.jsxs)(x.A,{fullWidth:!0,margin:"dense",required:!0,error:O.templateId&&!Q.templateId,children:[(0,U.jsx)(g.A,{id:"template-select-label",children:F("pages.quotations.fields.template")}),(0,U.jsxs)(A.A,{labelId:"template-select-label",id:"template-select",value:Q.templateId||"",label:F("pages.quotations.fields.template"),onChange:e=>{const t=e.target.value,n=v.find(e=>e.id===t);X((0,a.A)((0,a.A)({},Q),{},{templateId:t,templateName:(null===n||void 0===n?void 0:n.name)||""})),_(e=>(0,a.A)((0,a.A)({},e),{},{templateId:!0}))},onBlur:()=>_(e=>(0,a.A)((0,a.A)({},e),{},{templateId:!0})),size:"small",children:[(0,U.jsx)(f.A,{value:"",children:(0,U.jsx)("em",{children:F("pages.quotations.placeholders.selectTemplate")})}),v.map(e=>(0,U.jsx)(f.A,{value:e.id,children:e.name},e.id))]}),O.templateId&&!Q.templateId&&(0,U.jsx)(S.A,{children:F("pages.quotations.validation.selectTemplate")})]})]}),(0,U.jsx)(m.A,{label:F("pages.quotations.fields.name"),fullWidth:!0,required:!0,value:Q.name||"",onChange:e=>X((0,a.A)((0,a.A)({},Q),{},{name:e.target.value})),margin:"normal",size:"small",placeholder:F("pages.quotations.placeholders.name")}),(0,U.jsxs)(o.A,{sx:{display:"flex",gap:2,mb:3,flexWrap:"wrap"},children:[(0,U.jsx)(h.A,{options:p,value:Q.customer||null,onChange:(e,t)=>{X((0,a.A)((0,a.A)({},Q),{},{customer:t||"",dealId:0,dealName:"",requirementId:0,requirementName:""}))},renderInput:e=>(0,U.jsx)(m.A,(0,a.A)((0,a.A)({},e),{},{label:F("pages.quotations.fields.customer"),size:"small",sx:{minWidth:250,flex:1},required:!0})),sx:{minWidth:250,flex:1}}),(0,U.jsx)(h.A,{options:Y,getOptionLabel:e=>e.name,value:Q.dealId&&Y.find(e=>e.id===Q.dealId)||null,onChange:(e,t)=>{X((0,a.A)((0,a.A)({},Q),{},{dealId:(null===t||void 0===t?void 0:t.id)||0,dealName:(null===t||void 0===t?void 0:t.name)||"",requirementId:0,requirementName:""}))},renderInput:e=>(0,U.jsx)(m.A,(0,a.A)((0,a.A)({},e),{},{label:F("pages.quotations.fields.deal"),size:"small",sx:{minWidth:250,flex:1},required:!0})),sx:{minWidth:250,flex:1},disabled:!Q.customer})]}),(0,U.jsx)(o.A,{sx:{mb:3},children:(0,U.jsx)(h.A,{options:K,getOptionLabel:e=>e.name,value:Q.requirementId&&K.find(e=>e.id===Q.requirementId)||null,onChange:(e,t)=>{X((0,a.A)((0,a.A)({},Q),{},{requirementId:(null===t||void 0===t?void 0:t.id)||0,requirementName:(null===t||void 0===t?void 0:t.name)||""}))},renderInput:e=>(0,U.jsx)(m.A,(0,a.A)((0,a.A)({},e),{},{label:F("pages.quotations.fields.requirement"),size:"small",required:!0})),disabled:!Q.dealId})}),(0,U.jsx)(m.A,{label:F("pages.quotations.fields.status"),value:F("pages.quotations.status.draft"),size:"small",disabled:!0,fullWidth:!0,margin:"normal"}),(0,U.jsx)(m.A,{label:F("pages.quotations.fields.note"),multiline:!0,rows:4,fullWidth:!0,placeholder:F("pages.quotations.placeholders.note"),variant:"outlined",sx:{mb:2,mt:2},value:Q.note||"",onChange:e=>X((0,a.A)((0,a.A)({},Q),{},{note:e.target.value}))})]}),1===V&&(0,U.jsx)(o.A,{children:(0,U.jsxs)(u.A,{variant:"outlined",sx:{p:2,mb:2},children:[(0,U.jsx)(l.A,{variant:"subtitle2",gutterBottom:!0,children:F("pages.quotations.estimation.chooseMethod")}),(0,U.jsx)(ce,{mode:L,onModeChange:e=>{G(e),X(t=>(0,a.A)((0,a.A)({},t),{},{estimationMode:e}))},initialData:{rows:$},onEstimationDataChange:e=>{if("fixed"===e.mode){const t=e.rows.map(e=>({id:e.id,feature:e.feature||"",detail:e.detail||"",description:e.description||"",note:e.notes||"",frontendEffort:0,backendEffort:0,qcEffort:0,pmEffort:0,totalMD:Object.values(e.efforts||{}).reduce((e,t)=>e+(Number(t)||0),0),totalMM:0}));ee(t),te(t),X(t=>(0,a.A)((0,a.A)({},t),{},{estimationMode:"fixed",estimationConfig:{rows:e.rows,columns:e.columns}}))}else{const t=e.rates.map(e=>({id:e.id,feature:e.role||"",detail:e.description||"",description:"",note:"",frontendEffort:0,backendEffort:0,qcEffort:0,pmEffort:0,totalMD:e.rate||0,totalMM:0}));ee(t),te(t),X(t=>(0,a.A)((0,a.A)({},t),{},{estimationMode:"timeAndMaterial",estimationConfig:{rates:e.rates}}))}}})]})}),2===V&&(0,U.jsxs)(o.A,{children:[(0,U.jsx)(l.A,{variant:"h6",gutterBottom:!0,children:F("pages.quotations.steps.preview")}),(0,U.jsxs)(u.A,{variant:"outlined",sx:{p:3},children:[(0,U.jsxs)(o.A,{sx:{mb:3},children:[(0,U.jsx)(l.A,{variant:"subtitle1",gutterBottom:!0,children:F("pages.quotations.preview.customerInfo")}),(0,U.jsxs)(o.A,{sx:{pl:2},children:[(0,U.jsxs)(l.A,{children:[(0,U.jsxs)("strong",{children:[F("pages.quotations.fields.customer"),":"]})," ",Q.customer]}),(0,U.jsxs)(l.A,{children:[(0,U.jsxs)("strong",{children:[F("pages.quotations.fields.deal"),":"]})," ",Q.dealName]}),(0,U.jsxs)(l.A,{children:[(0,U.jsxs)("strong",{children:[F("pages.quotations.fields.requirement"),":"]})," ",Q.requirementName]})]})]}),(0,U.jsxs)(o.A,{sx:{mb:3},children:[(0,U.jsx)(l.A,{variant:"subtitle1",gutterBottom:!0,children:F("pages.quotations.preview.quotationDetails")}),(0,U.jsx)(D.A,{component:u.A,variant:"outlined",children:(0,U.jsxs)(N.A,{size:"small",children:[(0,U.jsx)(T.A,{children:(0,U.jsxs)(z.A,{children:[(0,U.jsx)(E.A,{children:F("pages.quotations.preview.table.no")}),(0,U.jsx)(E.A,{children:F("pages.quotations.preview.table.item")}),(0,U.jsx)(E.A,{children:F("pages.quotations.preview.table.description")}),(0,U.jsx)(E.A,{children:F("pages.quotations.preview.table.days")}),(0,U.jsx)(E.A,{children:F("pages.quotations.preview.table.unitPrice")}),(0,U.jsx)(E.A,{children:F("pages.quotations.preview.table.amount")})]})}),(0,U.jsxs)(P.A,{children:[$.map((e,t)=>(0,U.jsxs)(z.A,{children:[(0,U.jsx)(E.A,{children:t+1}),(0,U.jsx)(E.A,{children:e.feature}),(0,U.jsx)(E.A,{children:e.detail}),(0,U.jsx)(E.A,{children:e.totalMD}),(0,U.jsx)(E.A,{children:"500,000 VN\u0110/ng\xe0y"}),(0,U.jsxs)(E.A,{children:[(5e5*e.totalMD).toLocaleString("vi-VN")," VN\u0110"]})]},e.id)),(0,U.jsxs)(z.A,{children:[(0,U.jsx)(E.A,{colSpan:5,align:"right",children:(0,U.jsx)("strong",{children:F("pages.quotations.preview.table.total")})}),(0,U.jsx)(E.A,{children:(0,U.jsxs)("strong",{children:[null===(t=Q.totalAmount)||void 0===t?void 0:t.toLocaleString("vi-VN")," VN\u0110"]})})]})]})]})})]}),(0,U.jsxs)(o.A,{sx:{mb:3},children:[(0,U.jsx)(l.A,{variant:"subtitle1",gutterBottom:!0,children:F("pages.quotations.preview.notes")}),(0,U.jsx)(l.A,{variant:"body2",sx:{fontStyle:"italic"},children:Q.note||F("pages.quotations.preview.noNotes")})]})]})]})]}),(0,U.jsxs)(W.A,{sx:{p:2,pt:3},children:[(0,U.jsx)(r.A,{onClick:d,children:F("common.cancel")}),V>0&&(0,U.jsx)(r.A,{onClick:()=>{H(e=>e-1)},children:F("common.back")}),V<2?(0,U.jsx)(r.A,{variant:"contained",onClick:()=>{H(e=>e+1)},endIcon:(0,U.jsx)(B,{}),disabled:0===V&&!(Q.name&&Q.customer&&Q.dealId&&Q.requirementId&&Q.templateId),children:F(1===V?"pages.quotations.steps.preview":"common.next")}):(0,U.jsx)(r.A,{variant:"contained",color:"primary",onClick:()=>{Q.name&&Q.customer&&Q.templateId&&c((0,a.A)((0,a.A)({},Q),{},{items:$}))},startIcon:(0,U.jsx)(R.A,{}),children:F("common.save")})]})]})};var pe=n(83759),me=n(74917),he=n(4573);const xe=e=>{let{items:t,onItemsChange:n,readOnly:d=!1,disableFeatureFields:c=!1}=e;const{t:p}=(0,s.Bd)(),[h,x]=(0,i.useState)(t);(0,i.useEffect)(()=>{x(t)},[t]);const g=(e,t,i)=>{const s=h.map(n=>{if(n.id===e){const e=(0,a.A)((0,a.A)({},n),{},{[t]:i});if(["frontendEffort","backendEffort","qcEffort","pmEffort"].includes(t)){const n=("frontendEffort"===t?Number(i)||0:e.frontendEffort)+("backendEffort"===t?Number(i)||0:e.backendEffort)+("qcEffort"===t?Number(i)||0:e.qcEffort)+("pmEffort"===t?Number(i)||0:e.pmEffort),s=n/20;return(0,a.A)((0,a.A)({},e),{},{totalMD:n,totalMM:s})}return e}return n});x(s),n(s)},A=h.reduce((e,t)=>e+t.frontendEffort,0),f=h.reduce((e,t)=>e+t.backendEffort,0),b=h.reduce((e,t)=>e+t.qcEffort,0),v=h.reduce((e,t)=>e+t.pmEffort,0),y=h.reduce((e,t)=>e+t.totalMD,0),q=h.reduce((e,t)=>e+t.totalMM,0);return(0,U.jsxs)(o.A,{children:[(0,U.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",mb:2,alignItems:"center"},children:[(0,U.jsx)(l.A,{variant:"h6",children:p("pages.quotations.estimation.table.title")}),!d&&(0,U.jsx)(r.A,{variant:"outlined",startIcon:(0,U.jsx)(j.A,{}),onClick:()=>{const e={id:h.length>0?Math.max(...h.map(e=>e.id))+1:1,feature:"",detail:"",description:"",note:"",frontendEffort:0,backendEffort:0,qcEffort:0,pmEffort:0,totalMD:0,totalMM:0},t=[...h,e];x(t),n(t)},size:"small",children:p("pages.quotations.estimation.fixed.addRow")})]}),(0,U.jsx)(o.A,{sx:{width:"100%",overflow:"hidden"},children:(0,U.jsx)(D.A,{component:u.A,variant:"outlined",sx:{maxWidth:"100%",overflowX:"auto"},children:(0,U.jsxs)(N.A,{size:"small",sx:{tableLayout:"fixed"},children:[(0,U.jsx)(T.A,{children:(0,U.jsxs)(z.A,{children:[(0,U.jsx)(E.A,{width:"50px",sx:{position:"sticky",left:0,backgroundColor:"#fff",zIndex:1},children:p("pages.quotations.preview.table.no")}),(0,U.jsx)(E.A,{width:"150px",sx:{position:"sticky",left:"50px",backgroundColor:"#fff",zIndex:1},children:p("pages.quotations.estimation.table.feature")}),(0,U.jsx)(E.A,{width:"200px",sx:{position:"sticky",left:"200px",backgroundColor:"#fff",zIndex:1},children:p("pages.quotations.estimation.table.detail")}),(0,U.jsx)(E.A,{width:"250px",sx:{position:"sticky",left:"400px",backgroundColor:"#fff",zIndex:1},children:p("pages.quotations.estimation.table.description")}),(0,U.jsx)(E.A,{width:"200px",sx:{position:"sticky",left:"650px",backgroundColor:"#fff",zIndex:1},children:p("pages.quotations.estimation.table.note")}),(0,U.jsx)(E.A,{align:"right",width:"80px",children:p("pages.quotations.estimation.table.columns.feMd")}),(0,U.jsx)(E.A,{align:"right",width:"80px",children:p("pages.quotations.estimation.table.columns.beMd")}),(0,U.jsx)(E.A,{align:"right",width:"80px",children:p("pages.quotations.estimation.table.columns.qcMd")}),(0,U.jsx)(E.A,{align:"right",width:"80px",children:p("pages.quotations.estimation.table.columns.pmMd")}),(0,U.jsx)(E.A,{align:"right",width:"80px",children:p("pages.quotations.estimation.table.columns.totalMd")}),(0,U.jsx)(E.A,{align:"right",width:"80px",children:p("pages.quotations.estimation.table.columns.totalMm")}),!d&&(0,U.jsx)(E.A,{align:"center",width:"80px",children:p("pages.quotations.tables.actions")})]})}),(0,U.jsxs)(P.A,{children:[h.map((e,t)=>(0,U.jsxs)(z.A,{children:[(0,U.jsx)(E.A,{sx:{position:"sticky",left:0,backgroundColor:"#fff",zIndex:1},children:t+1}),(0,U.jsx)(E.A,{sx:{position:"sticky",left:"50px",backgroundColor:"#fff",zIndex:1},children:d?(0,U.jsx)(K.A,{title:e.feature,arrow:!0,placement:"top",children:(0,U.jsx)("div",{style:{maxWidth:"150px",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:e.feature})}):(0,U.jsx)(m.A,{variant:"outlined",size:"small",value:e.feature,onChange:t=>g(e.id,"feature",t.target.value),fullWidth:!0,multiline:!0,maxRows:3,disabled:c})}),(0,U.jsx)(E.A,{sx:{position:"sticky",left:"200px",backgroundColor:"#fff",zIndex:1},children:d?(0,U.jsx)(K.A,{title:e.detail,arrow:!0,placement:"top",children:(0,U.jsx)("div",{style:{maxWidth:"150px",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:e.detail})}):(0,U.jsx)(m.A,{variant:"outlined",size:"small",value:e.detail,onChange:t=>g(e.id,"detail",t.target.value),fullWidth:!0,multiline:!0,maxRows:3,disabled:c})}),(0,U.jsx)(E.A,{sx:{position:"sticky",left:"400px",backgroundColor:"#fff",zIndex:1},children:d?(0,U.jsx)(K.A,{title:e.description,arrow:!0,placement:"top",children:(0,U.jsx)("div",{style:{maxWidth:"150px",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:e.description})}):(0,U.jsx)(m.A,{variant:"outlined",size:"small",value:e.description,onChange:t=>g(e.id,"description",t.target.value),fullWidth:!0,multiline:!0,maxRows:3,disabled:c})}),(0,U.jsx)(E.A,{sx:{position:"sticky",left:"650px",backgroundColor:"#fff",zIndex:1},children:d?(0,U.jsx)(K.A,{title:e.note,arrow:!0,placement:"top",children:(0,U.jsx)("div",{style:{maxWidth:"150px",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:e.note})}):(0,U.jsx)(m.A,{variant:"outlined",size:"small",value:e.note,onChange:t=>g(e.id,"note",t.target.value),fullWidth:!0,multiline:!0,maxRows:3,disabled:c})}),(0,U.jsx)(E.A,{align:"right",children:d?e.frontendEffort:(0,U.jsx)(m.A,{variant:"outlined",size:"small",type:"number",value:e.frontendEffort,onChange:t=>g(e.id,"frontendEffort",Number(t.target.value)),inputProps:{min:0},sx:{width:"50px","& input::-webkit-outer-spin-button, & input::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]":{"-moz-appearance":"textfield"}}})}),(0,U.jsx)(E.A,{align:"right",children:d?e.backendEffort:(0,U.jsx)(m.A,{variant:"outlined",size:"small",type:"number",value:e.backendEffort,onChange:t=>g(e.id,"backendEffort",Number(t.target.value)),inputProps:{min:0},sx:{width:"50px","& input::-webkit-outer-spin-button, & input::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]":{"-moz-appearance":"textfield"}}})}),(0,U.jsx)(E.A,{align:"right",children:d?e.qcEffort:(0,U.jsx)(m.A,{variant:"outlined",size:"small",type:"number",value:e.qcEffort,onChange:t=>g(e.id,"qcEffort",Number(t.target.value)),inputProps:{min:0},sx:{width:"50px","& input::-webkit-outer-spin-button, & input::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]":{"-moz-appearance":"textfield"}}})}),(0,U.jsx)(E.A,{align:"right",children:d?e.pmEffort:(0,U.jsx)(m.A,{variant:"outlined",size:"small",type:"number",value:e.pmEffort,onChange:t=>g(e.id,"pmEffort",Number(t.target.value)),inputProps:{min:0},sx:{width:"50px","& input::-webkit-outer-spin-button, & input::-webkit-inner-spin-button":{"-webkit-appearance":"none",margin:0},"& input[type=number]":{"-moz-appearance":"textfield"}}})}),(0,U.jsx)(E.A,{align:"right",children:(0,U.jsx)("strong",{children:e.totalMD.toFixed(1)})}),(0,U.jsx)(E.A,{align:"right",children:(0,U.jsx)("strong",{children:e.totalMM.toFixed(2)})}),!d&&(0,U.jsx)(E.A,{align:"center",children:(0,U.jsx)(J.A,{size:"small",color:"error",onClick:()=>(e=>{const t=h.filter(t=>t.id!==e);x(t),n(t)})(e.id),disabled:h.length<=1,children:(0,U.jsx)(ae.A,{fontSize:"small"})})})]},e.id)),(0,U.jsxs)(z.A,{sx:{backgroundColor:"action.hover"},children:[(0,U.jsx)(E.A,{sx:{position:"sticky",left:0,backgroundColor:"#f5f5f5",zIndex:1}}),(0,U.jsx)(E.A,{sx:{position:"sticky",left:"50px",backgroundColor:"#f5f5f5",zIndex:1}}),(0,U.jsx)(E.A,{sx:{position:"sticky",left:"200px",backgroundColor:"#f5f5f5",zIndex:1}}),(0,U.jsx)(E.A,{sx:{position:"sticky",left:"400px",backgroundColor:"#f5f5f5",zIndex:1}}),(0,U.jsx)(E.A,{sx:{position:"sticky",left:"650px",backgroundColor:"#f5f5f5",zIndex:1},align:"right",children:(0,U.jsx)("strong",{children:p("pages.quotations.estimation.table.total")})}),(0,U.jsx)(E.A,{align:"right",children:(0,U.jsx)("strong",{children:A.toFixed(1)})}),(0,U.jsx)(E.A,{align:"right",children:(0,U.jsx)("strong",{children:f.toFixed(1)})}),(0,U.jsx)(E.A,{align:"right",children:(0,U.jsx)("strong",{children:b.toFixed(1)})}),(0,U.jsx)(E.A,{align:"right",children:(0,U.jsx)("strong",{children:v.toFixed(1)})}),(0,U.jsx)(E.A,{align:"right",children:(0,U.jsx)("strong",{children:y.toFixed(1)})}),(0,U.jsx)(E.A,{align:"right",children:(0,U.jsx)("strong",{children:q.toFixed(2)})}),!d&&(0,U.jsx)(E.A,{})]})]})]})})}),(0,U.jsxs)(o.A,{sx:{mt:2,display:"flex",justifyContent:"flex-end",gap:2},children:[(0,U.jsxs)(l.A,{variant:"body2",children:[(0,U.jsxs)("strong",{children:[p("pages.quotations.estimation.table.summary.totalMd"),":"]})," ",y.toFixed(1)]}),(0,U.jsxs)(l.A,{variant:"body2",children:[(0,U.jsxs)("strong",{children:[p("pages.quotations.estimation.table.summary.totalMm"),":"]})," ",q.toFixed(2)]}),(0,U.jsxs)(l.A,{variant:"body2",children:[(0,U.jsxs)("strong",{children:[p("pages.quotations.estimation.table.summary.totalAmount"),":"]})," ",new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(5e5*y)]})]})]})},ge=e=>{let{open:t,onClose:n,quotation:a}=e;const{t:i,i18n:d}=(0,s.Bd)();if(!a)return null;return(0,U.jsxs)(y.A,{open:t,onClose:n,maxWidth:"lg",fullWidth:!0,children:[(0,U.jsx)(q.A,{children:(0,U.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,U.jsx)(l.A,{variant:"h6",children:i("pages.quotations.detail.title","Quotation details")}),(e=>{const t={draft:{label:i("pages.quotations.status.draft","Draft"),color:"default"},sent:{label:i("pages.quotations.status.sent","Sent"),color:"info"},approved:{label:i("pages.quotations.status.approved","Approved"),color:"success"},rejected:{label:i("pages.quotations.status.rejected","Rejected"),color:"error"}}[e];return(0,U.jsx)(pe.A,{label:t.label,color:t.color,size:"small"})})(a.status)]})}),(0,U.jsxs)(w.A,{children:[(0,U.jsxs)(u.A,{variant:"outlined",sx:{p:3,mb:3},children:[(0,U.jsx)(l.A,{variant:"h6",gutterBottom:!0,sx:{fontWeight:"bold",color:"primary.main"},children:i("pages.quotations.detail.basicInfo","Basic information")}),(0,U.jsxs)(o.A,{sx:{display:"flex",flexWrap:"wrap",gap:3},children:[(0,U.jsxs)(o.A,{sx:{minWidth:"200px",flex:1},children:[(0,U.jsx)(l.A,{variant:"body2",color:"text.secondary",children:i("pages.quotations.detail.fields.name","Quotation name")}),(0,U.jsx)(l.A,{variant:"body1",sx:{fontWeight:"medium"},children:a.name})]}),(0,U.jsxs)(o.A,{sx:{minWidth:"200px",flex:1},children:[(0,U.jsx)(l.A,{variant:"body2",color:"text.secondary",children:i("pages.quotations.detail.fields.customer","Customer")}),(0,U.jsx)(l.A,{variant:"body1",children:a.customer})]}),(0,U.jsxs)(o.A,{sx:{minWidth:"200px",flex:1},children:[(0,U.jsx)(l.A,{variant:"body2",color:"text.secondary",children:i("pages.quotations.detail.fields.deal","Deal")}),(0,U.jsx)(l.A,{variant:"body1",children:a.dealName})]}),(0,U.jsxs)(o.A,{sx:{minWidth:"200px",flex:1},children:[(0,U.jsx)(l.A,{variant:"body2",color:"text.secondary",children:i("pages.quotations.detail.fields.requirement","Requirement")}),(0,U.jsx)(l.A,{variant:"body1",children:a.requirementName})]})]}),(0,U.jsxs)(o.A,{sx:{display:"flex",flexWrap:"wrap",gap:3,mt:3},children:[(0,U.jsxs)(o.A,{sx:{minWidth:"200px",flex:1},children:[(0,U.jsx)(l.A,{variant:"body2",color:"text.secondary",children:i("pages.quotations.detail.fields.createdDate","Created date")}),(0,U.jsx)(l.A,{variant:"body1",children:a.createdDate})]}),(0,U.jsxs)(o.A,{sx:{minWidth:"200px",flex:1},children:[(0,U.jsx)(l.A,{variant:"body2",color:"text.secondary",children:i("pages.quotations.detail.fields.totalEffort","Total effort")}),(0,U.jsxs)(l.A,{variant:"body1",children:[a.totalEffort," MD"]})]}),(0,U.jsxs)(o.A,{sx:{minWidth:"200px",flex:1},children:[(0,U.jsx)(l.A,{variant:"body2",color:"text.secondary",children:i("pages.quotations.detail.fields.totalAmount","Total amount")}),(0,U.jsx)(l.A,{variant:"body1",sx:{fontWeight:"bold",color:"primary.main"},children:(e=>{const t=d.language||"en",{locale:n,currency:a}=t.startsWith("ja")?{locale:"ja-JP",currency:"JPY"}:t.startsWith("vi")?{locale:"vi-VN",currency:"VND"}:{locale:"en-US",currency:"USD"};return new Intl.NumberFormat(n,{style:"currency",currency:a}).format(e)})(a.totalAmount)})]})]})]}),a.note&&(0,U.jsxs)(u.A,{variant:"outlined",sx:{p:3,mb:3},children:[(0,U.jsx)(l.A,{variant:"h6",gutterBottom:!0,sx:{fontWeight:"bold",color:"primary.main"},children:i("pages.quotations.detail.note","Note")}),(0,U.jsx)(l.A,{variant:"body1",sx:{whiteSpace:"pre-wrap"},children:a.note})]}),(0,U.jsx)(L.A,{sx:{my:3}}),(0,U.jsx)(l.A,{variant:"h6",gutterBottom:!0,sx:{fontWeight:"bold",color:"primary.main",mb:2},children:i("pages.quotations.detail.estimateTitle","Estimation details")}),a.items&&a.items.length>0?(0,U.jsx)(xe,{items:a.items,onItemsChange:()=>{},readOnly:!0}):(0,U.jsx)(u.A,{variant:"outlined",sx:{p:2},children:(0,U.jsx)(l.A,{variant:"body1",color:"text.secondary",children:i("pages.quotations.detail.noEstimateData","No estimation data.")})}),a.executiveSummary&&(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(L.A,{sx:{my:3}}),(0,U.jsxs)(u.A,{variant:"outlined",sx:{p:3,mb:3},children:[(0,U.jsx)(l.A,{variant:"h6",gutterBottom:!0,sx:{fontWeight:"bold",color:"primary.main"},children:i("pages.quotations.detail.executiveSummary","Executive summary")}),(0,U.jsx)(l.A,{variant:"body1",sx:{whiteSpace:"pre-wrap"},children:a.executiveSummary})]})]})]}),(0,U.jsxs)(W.A,{sx:{p:2},children:[(0,U.jsx)(r.A,{onClick:n,children:i("common.close","Close")}),(0,U.jsx)(r.A,{startIcon:(0,U.jsx)(ne.A,{}),variant:"outlined",onClick:()=>console.log("Edit quotation"),children:i("common.edit","Edit")}),(0,U.jsx)(r.A,{startIcon:(0,U.jsx)(me.A,{}),variant:"outlined",color:"secondary",onClick:()=>console.log("Download PDF"),children:i("common.downloadPdf","Download PDF")}),(0,U.jsx)(r.A,{startIcon:(0,U.jsx)(he.A,{}),variant:"contained",color:"primary",onClick:()=>console.log("Send email"),children:i("pages.quotations.detail.actions.sendEmail","Send Email")})]})]})};var Ae=n(94084);const fe=e=>{let{open:t,onClose:n,quotation:d,onSaveDraft:c,onExportPdf:u}=e;const{t:p,i18n:m}=(0,s.Bd)(),[h,x]=(0,i.useState)([""]),g="ja"===m.language?"ja-JP":"vi"===m.language?"vi-VN":"en-US";(0,i.useEffect)(()=>{if(d){const e=d.pages;e&&Array.isArray(e)&&e.length>0?x(e):x(['\n          <div style="padding: 20mm;">\n            <h1 style="text-align: center; margin-bottom: 30px;">'.concat(p("pages.quotations.preview.page.heading"),'</h1>\n            <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">\n              <div>\n                <p><strong>').concat(p("pages.quotations.preview.page.customer"),":</strong> ").concat(d.customer||p("pages.quotations.preview.page.customerDefault"),"</p>\n                <p><strong>").concat(p("pages.quotations.preview.page.project"),":</strong> ").concat(d.name||p("pages.quotations.preview.page.projectDefault"),'</p>\n              </div>\n              <div style="text-align: right;">\n                <p><strong>').concat(p("pages.quotations.preview.page.quotationId"),":</strong> ").concat(d.id||"N/A","</p>\n                <p><strong>").concat(p("pages.quotations.preview.page.createdDate"),":</strong> ").concat(new Date(d.createdDate||new Date).toLocaleDateString(g),'</p>\n              </div>\n            </div>\n            \n            \x3c!-- Quotation items table --\x3e\n            <div style="margin: 20px 0;">\n              <h3>').concat(p("pages.quotations.preview.page.itemsTitle"),'</h3>\n              <table style="width: 100%; border-collapse: collapse; margin: 15px 0;">\n                <thead>\n                  <tr style="background-color: #f5f5f5;">\n                    <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">').concat(p("pages.quotations.preview.page.columns.stt"),'</th>\n                    <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">').concat(p("pages.quotations.preview.page.columns.description"),'</th>\n                    <th style="border: 1px solid #ddd; padding: 8px; text-align: right;">').concat(p("pages.quotations.preview.page.columns.days"),'</th>\n                    <th style="border: 1px solid #ddd; padding: 8px; text-align: right;">').concat(p("pages.quotations.preview.page.columns.unitPriceVnd"),'</th>\n                    <th style="border: 1px solid #ddd; padding: 8px; text-align: right;">').concat(p("pages.quotations.preview.page.columns.amountVnd"),"</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  ").concat((d.items||[]).map((e,t)=>{const n=e.qcEffort||0,a=e.rate||0,i=n*a,s=new Intl.NumberFormat(g);return'\n                      <tr>\n                        <td style="border: 1px solid #ddd; padding: 8px;">'.concat(t+1,'</td>\n                        <td style="border: 1px solid #ddd; padding: 8px;">').concat(e.description||"",'</td>\n                        <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">').concat(n,'</td>\n                        <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">').concat(s.format(a),'</td>\n                        <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">').concat(s.format(i),"</td>\n                      </tr>\n                    ")}).join(""),'\n                  <tr>\n                    <td colspan="4" style="border: 1px solid #ddd; padding: 8px; text-align: right;"><strong>').concat(p("pages.quotations.preview.page.total"),'</strong></td>\n                    <td style="border: 1px solid #ddd; padding: 8px; text-align: right; font-weight: bold;">\n                      ').concat(new Intl.NumberFormat(g).format((d.items||[]).reduce((e,t)=>e+(t.qcEffort||0)*(t.rate||0),0)),' VND\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n            \n            <div style="margin-top: 30px;">\n              <div style="margin-bottom: 20px;">\n                <h3>').concat(p("pages.quotations.preview.page.paymentTerms"),"</h3>\n                <div>").concat(d.paymentTerms||p("pages.quotations.preview.page.paymentTermsDefault"),'</div>\n              </div>\n              <div style="margin-top: 60px; display: flex; justify-content: space-between;">\n                <div style="text-align: center; width: 50%;">\n                  <p><strong>').concat(p("pages.quotations.preview.page.sellerRep"),'</strong></p>\n                  <p style="font-style: italic; margin-top: 50px;">').concat(p("pages.quotations.preview.page.signNote"),'</p>\n                </div>\n                <div style="text-align: center; width: 50%;">\n                  <p><strong>').concat(p("pages.quotations.preview.page.buyerRep"),'</strong></p>\n                  <p style="font-style: italic; margin-top: 50px;">').concat(p("pages.quotations.preview.page.signNote"),"</p>\n                </div>\n              </div>\n            </div>\n          </div>\n          ")])}},[d]);return(0,U.jsxs)(y.A,{open:t,onClose:n,maxWidth:"xl",fullWidth:!0,sx:{"& .MuiDialog-paper":{maxWidth:"95%",height:"95vh"}},children:[(0,U.jsx)(q.A,{children:(0,U.jsx)(l.A,{variant:"h6",children:p("pages.quotations.preview.dialogTitle")})}),(0,U.jsx)(w.A,{sx:{p:0,display:"flex",flexDirection:"column",height:"100%"},children:d?(0,U.jsx)(Ae.z,{initialContent:h,onSave:e=>{x(e)},onExportPdf:()=>u&&u(d)}):(0,U.jsx)(o.A,{sx:{p:3,textAlign:"center"},children:(0,U.jsx)(l.A,{children:p("pages.quotations.preview.loading")})})}),(0,U.jsxs)(W.A,{children:[(0,U.jsx)(r.A,{onClick:n,color:"inherit",children:p("pages.quotations.preview.buttons.close")}),(0,U.jsx)(r.A,{onClick:()=>{if(c&&d){const e=(0,a.A)((0,a.A)({},d),h.length>0&&{pages:h});c(e)}},variant:"contained",color:"primary",startIcon:(0,U.jsx)(R.A,{}),disabled:!d,children:p("pages.quotations.preview.buttons.saveDraft")})]})]})};var je=n(3665);const be=e=>{let{quotations:t,page:n,rowsPerPage:a,totalCount:i,onPageChange:o,onRowsPerPageChange:l,onViewDetail:r,onDownloadPdf:d,onSendEmail:c}=e;const{t:p,i18n:m}=(0,s.Bd)(),h=e=>{const t={draft:{label:p("pages.quotations.status.draft"),color:"default"},sent:{label:p("pages.quotations.status.sent"),color:"info"},approved:{label:p("pages.quotations.status.approved"),color:"success"},rejected:{label:p("pages.quotations.status.rejected"),color:"error"}}[e];return(0,U.jsx)(pe.A,{label:t.label,color:t.color,size:"small"})},x=e=>{const t=m.language||"en",{locale:n,currency:a}=t.startsWith("ja")?{locale:"ja-JP",currency:"JPY"}:t.startsWith("vi")?{locale:"vi-VN",currency:"VND"}:{locale:"en-US",currency:"USD"};return new Intl.NumberFormat(n,{style:"currency",currency:a}).format(e)},g=e=>{const t=m.language||"en",n=t.startsWith("ja")?"ja-JP":t.startsWith("vi")?"vi-VN":"en-US",a=new Date(e);return Number.isNaN(a.getTime())?e:new Intl.DateTimeFormat(n,{year:"numeric",month:"2-digit",day:"2-digit"}).format(a)};return(0,U.jsx)(U.Fragment,{children:(0,U.jsxs)(D.A,{component:u.A,children:[(0,U.jsxs)(N.A,{children:[(0,U.jsx)(T.A,{children:(0,U.jsxs)(z.A,{children:[(0,U.jsx)(E.A,{children:p("pages.quotations.columns.name")}),(0,U.jsx)(E.A,{children:p("pages.quotations.columns.customer")}),(0,U.jsx)(E.A,{children:p("pages.quotations.columns.deal")}),(0,U.jsx)(E.A,{children:p("pages.quotations.columns.status")}),(0,U.jsx)(E.A,{children:p("pages.quotations.columns.createdAt")}),(0,U.jsx)(E.A,{align:"right",children:p("pages.quotations.columns.effort")}),(0,U.jsx)(E.A,{align:"right",children:p("pages.quotations.columns.amount")}),(0,U.jsx)(E.A,{align:"center",children:p("pages.quotations.columns.actions")})]})}),(0,U.jsxs)(P.A,{children:[t.map(e=>(0,U.jsxs)(z.A,{children:[(0,U.jsx)(E.A,{children:e.name}),(0,U.jsx)(E.A,{children:e.customer}),(0,U.jsx)(E.A,{children:e.dealName}),(0,U.jsx)(E.A,{children:h(e.status)}),(0,U.jsx)(E.A,{children:g(e.createdDate)}),(0,U.jsx)(E.A,{align:"right",children:e.totalEffort}),(0,U.jsx)(E.A,{align:"right",children:x(e.totalAmount)}),(0,U.jsxs)(E.A,{align:"center",children:[(0,U.jsx)(J.A,{size:"small",color:"primary",onClick:()=>r(e.id),title:p("common.view"),children:(0,U.jsx)(je.A,{fontSize:"small"})}),(0,U.jsx)(J.A,{size:"small",color:"secondary",onClick:()=>d(e.id),title:p("common.download"),children:(0,U.jsx)(me.A,{fontSize:"small"})}),(0,U.jsx)(J.A,{size:"small",color:"info",onClick:()=>c(e.id),title:p("common.sendEmail"),children:(0,U.jsx)(he.A,{fontSize:"small"})})]})]},e.id)),0===t.length&&(0,U.jsx)(z.A,{children:(0,U.jsx)(E.A,{colSpan:8,align:"center",children:p("common.noData")})})]})]}),(0,U.jsx)($.A,{component:"div",count:i,page:n,onPageChange:(e,t)=>o(e,t),rowsPerPage:a,onRowsPerPageChange:e=>l(e),rowsPerPageOptions:[5,10,25],labelRowsPerPage:p("pages.quotations.pagination.rowsPerPage")})]})})};var ve=n(27421),ye=n(17171);const qe=e=>{let{open:t,onClose:n,onSend:d,customerName:c,serviceName:u,responsiblePerson:p,pdfFileName:h}=e;const{t:x}=(0,s.Bd)(),[g,A]=(0,i.useState)({to:"",cc:"",subject:x("pages.quotations.emailDialog.defaultSubject",{serviceName:u}),content:x("pages.quotations.emailDialog.defaultContent",{customerName:c||x("pages.quotations.emailDialog.dearCustomer"),serviceName:u||x("pages.quotations.emailDialog.theService"),responsiblePerson:p||x("pages.quotations.emailDialog.teamSignature"),interpolation:{escapeValue:!1}})}),f=e=>t=>{A(n=>(0,a.A)((0,a.A)({},n),{},{[e]:t.target.value}))};return(0,U.jsxs)(y.A,{open:t,onClose:n,maxWidth:"md",fullWidth:!0,children:[(0,U.jsx)(q.A,{children:(0,U.jsxs)(o.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,U.jsx)(l.A,{variant:"h6",children:x("pages.quotations.emailDialog.title")}),(0,U.jsx)(J.A,{onClick:n,size:"small",children:(0,U.jsx)(ve.A,{})})]})}),(0,U.jsx)(w.A,{dividers:!0,children:(0,U.jsxs)(o.A,{mb:3,children:[(0,U.jsx)(m.A,{fullWidth:!0,label:x("pages.quotations.emailDialog.to"),value:g.to,onChange:f("to"),margin:"normal",variant:"outlined"}),(0,U.jsx)(m.A,{fullWidth:!0,label:x("pages.quotations.emailDialog.ccOptional"),value:g.cc,onChange:f("cc"),margin:"normal",variant:"outlined"}),(0,U.jsx)(m.A,{fullWidth:!0,label:x("pages.quotations.emailDialog.subject"),value:g.subject,onChange:f("subject"),margin:"normal",variant:"outlined"}),(0,U.jsxs)(o.A,{mt:2,mb:2,display:"flex",alignItems:"center",children:[(0,U.jsxs)(l.A,{variant:"body1",sx:{mr:2},children:[x("pages.quotations.emailDialog.attachment"),": ",h]}),(0,U.jsx)(J.A,{size:"small",onClick:()=>window.open("/preview/".concat(h),"_blank"),children:(0,U.jsx)(je.A,{})})]}),(0,U.jsx)(m.A,{fullWidth:!0,label:x("pages.quotations.emailDialog.content"),value:g.content,onChange:f("content"),margin:"normal",variant:"outlined",multiline:!0,rows:8})]})}),(0,U.jsxs)(W.A,{sx:{p:2},children:[(0,U.jsx)(r.A,{onClick:n,children:x("common.cancel")}),(0,U.jsx)(r.A,{variant:"contained",color:"primary",startIcon:(0,U.jsx)(ye.A,{}),onClick:()=>{d(g),n()},disabled:!g.to,children:x("common.sendEmail")})]})]})},we=e=>{let{templates:t,loading:n,onUploadClick:a,onViewTemplate:i,onDeleteTemplate:d,onDownloadTemplate:c}=e;const{t:p,i18n:m}=(0,s.Bd)(),h=e=>{const t=m.language||"en",n=t.startsWith("ja")?"ja-JP":t.startsWith("vi")?"vi-VN":"en-US",a=new Date(e);return Number.isNaN(a.getTime())?e:new Intl.DateTimeFormat(n,{year:"numeric",month:"2-digit",day:"2-digit"}).format(a)};return(0,U.jsxs)(u.A,{sx:{p:3},children:[(0,U.jsxs)(o.A,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[(0,U.jsx)(l.A,{variant:"h6",children:p("pages.quotations.templates.title")}),(0,U.jsx)(r.A,{variant:"contained",color:"primary",startIcon:(0,U.jsx)(j.A,{}),onClick:a,children:p("pages.quotations.templates.buttons.uploadTemplate")})]}),(0,U.jsx)(D.A,{children:(0,U.jsxs)(N.A,{children:[(0,U.jsx)(T.A,{children:(0,U.jsxs)(z.A,{children:[(0,U.jsx)(E.A,{children:p("pages.quotations.templates.table.columns.name")}),(0,U.jsx)(E.A,{children:p("pages.quotations.templates.table.columns.description")}),(0,U.jsx)(E.A,{children:p("pages.quotations.templates.table.columns.type")}),(0,U.jsx)(E.A,{children:p("pages.quotations.templates.table.columns.status")}),(0,U.jsx)(E.A,{children:p("pages.quotations.templates.table.columns.createdAt")}),(0,U.jsx)(E.A,{children:p("pages.quotations.templates.table.columns.createdBy")}),(0,U.jsx)(E.A,{children:p("pages.quotations.templates.table.columns.fields")}),(0,U.jsx)(E.A,{align:"center",children:p("pages.quotations.tables.actions")})]})}),(0,U.jsx)(P.A,{children:n?(0,U.jsx)(z.A,{children:(0,U.jsx)(E.A,{colSpan:8,align:"center",children:p("pages.quotations.templates.loading")})}):0===t.length?(0,U.jsx)(z.A,{children:(0,U.jsx)(E.A,{colSpan:8,align:"center",children:p("pages.quotations.templates.table.empty")})}):t.map(e=>(0,U.jsxs)(z.A,{children:[(0,U.jsx)(E.A,{children:e.name}),(0,U.jsx)(E.A,{children:e.description||"-"}),(0,U.jsx)(E.A,{children:"customer"===e.type?p("pages.quotations.templates.table.chips.type.customer"):p("pages.quotations.templates.table.chips.type.internal")}),(0,U.jsxs)(E.A,{children:[(0,U.jsx)(pe.A,{label:"active"===e.status?p("pages.quotations.templates.table.chips.status.active"):p("pages.quotations.templates.table.chips.status.inactive"),color:"active"===e.status?"success":"default",size:"small"}),e.isDefault&&(0,U.jsx)(pe.A,{label:p("pages.quotations.templates.table.chips.default"),color:"primary",size:"small",sx:{ml:1}})]}),(0,U.jsx)(E.A,{children:h(e.createdAt)}),(0,U.jsx)(E.A,{children:e.createdBy}),(0,U.jsx)(E.A,{children:e.placeholderCount}),(0,U.jsx)(E.A,{align:"center",children:(0,U.jsxs)(o.A,{children:[i&&(0,U.jsx)(K.A,{title:p("pages.quotations.templates.table.tooltips.view"),children:(0,U.jsx)(J.A,{size:"small",onClick:()=>i(e.id),children:(0,U.jsx)(je.A,{fontSize:"small"})})}),c&&(0,U.jsx)(K.A,{title:p("pages.quotations.templates.table.tooltips.download"),children:(0,U.jsx)(J.A,{size:"small",onClick:()=>c(e.id),children:(0,U.jsx)(v.A,{fontSize:"small"})})}),d&&(0,U.jsx)(K.A,{title:p("pages.quotations.templates.table.tooltips.delete"),children:(0,U.jsx)(J.A,{size:"small",color:"error",onClick:()=>d(e.id),children:(0,U.jsx)(ae.A,{fontSize:"small"})})})]})})]},e.id))})]})})]})};var Ce=n(80172),ke=n(51697);const Ie=e=>{let{open:t,onClose:n,onSubmit:d}=e;const{t:c}=(0,s.Bd)(),[p,h]=(0,i.useState)({name:"",description:"",type:"customer",file:null,extractedFields:[]}),[j,b]=(0,i.useState)(!1),[v,C]=(0,i.useState)(!1),[k,I]=(0,i.useState)([]),S=e=>{const{name:t,value:n}=e.target;t&&h(e=>(0,a.A)((0,a.A)({},e),{},{[t]:n}))},M=(e,t,n)=>{const i=[...k];i[e]=(0,a.A)((0,a.A)({},i[e]),{},{[t]:n}),I(i),h(e=>(0,a.A)((0,a.A)({},e),{},{extractedFields:i}))},F=()=>{h({name:"",description:"",type:"customer",file:null,extractedFields:[]}),I([]),n()};return(0,U.jsxs)(y.A,{open:t,onClose:F,maxWidth:"lg",fullWidth:!0,children:[(0,U.jsx)(q.A,{children:(0,U.jsxs)(o.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,U.jsx)(l.A,{variant:"h6",children:c("pages.quotations.templateUpload.title")}),(0,U.jsx)(J.A,{onClick:F,size:"small",children:(0,U.jsx)(ve.A,{})})]})}),(0,U.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),p.name.trim())if(p.file)try{b(!0),await d(p),F()}catch(t){console.error("Error submitting template:",t)}finally{b(!1)}else alert(c("pages.quotations.templateUpload.validations.missingFile"));else alert(c("pages.quotations.templateUpload.validations.missingName"))},children:[(0,U.jsx)(w.A,{dividers:!0,children:(0,U.jsxs)(o.A,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 2fr"},gap:3},children:[(0,U.jsxs)(o.A,{children:[(0,U.jsx)(m.A,{label:c("pages.quotations.templateUpload.fields.name"),name:"name",value:p.name,onChange:S,fullWidth:!0,margin:"normal",required:!0,disabled:j}),(0,U.jsx)(m.A,{label:c("pages.quotations.templateUpload.fields.description"),name:"description",value:p.description,onChange:S,fullWidth:!0,multiline:!0,rows:3,margin:"normal",disabled:j}),(0,U.jsxs)(x.A,{fullWidth:!0,margin:"normal",children:[(0,U.jsx)(g.A,{children:c("pages.quotations.templateUpload.fields.type")}),(0,U.jsxs)(A.A,{label:c("pages.quotations.templateUpload.fields.type"),name:"type",value:p.type,onChange:S,disabled:j,children:[(0,U.jsx)(f.A,{value:"customer",children:c("pages.quotations.templateUpload.options.type.customer")}),(0,U.jsx)(f.A,{value:"internal",children:c("pages.quotations.templateUpload.options.type.internal")})]})]}),(0,U.jsxs)(o.A,{mt:2,mb:2,children:[(0,U.jsx)("input",{accept:c("pages.quotations.templateUpload.file.accept"),style:{display:"none"},id:"template-upload",type:"file",onChange:e=>{var t;const n=(null===(t=e.target.files)||void 0===t?void 0:t[0])||null;if(n){if(!n.name.endsWith(".docx")&&!n.name.endsWith(".doc")&&!n.name.endsWith(".pdf"))return void alert(c("pages.quotations.templateUpload.validations.invalidFormat"));if(n.size>5242880)return void alert(c("pages.quotations.templateUpload.validations.oversize"));h(e=>(0,a.A)((0,a.A)({},e),{},{file:n})),C(!0),setTimeout(()=>{const e=[{originalText:"C\xd4NG TY TNHH GI\u1ea4Y CAO PH\xc1T",placeholder:"TEN_CONG_TY_A",type:"text",description:"T\xean c\xf4ng ty b\xean A",required:!0,example:"C\xf4ng ty TNHH ABC"},{originalText:"S\u1ed1 352, Khu Ph\u1ed1 M\u1ef9 Hi\u1ec7p, Ph\u01b0\u1eddng Th\xe1i Ho\xe0, Th\xe0nh ph\u1ed1 T\xe2n Uy\xean, T\u1ec9nh B\xecnh D\u01b0\u01a1ng",placeholder:"DIA_CHI_A",type:"text",description:"\u0110\u1ecba ch\u1ec9 b\xean A",required:!0,example:"S\u1ed1 123, \u0110\u01b0\u1eddng ABC, Qu\u1eadn 1, TP.HCM"},{originalText:"0274 3775 179",placeholder:"DIEN_THOAI_A",type:"phone",description:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i b\xean A",required:!0,example:"0901234567"},{originalText:"3701711279",placeholder:"MA_SO_THUE_A",type:"taxcode",description:"M\xe3 s\u1ed1 thu\u1ebf b\xean A",required:!0,example:"0123456789"},{originalText:"L\xca TH\u1eca KIM CHI",placeholder:"NGUOI_DAI_DIEN_A",type:"text",description:"Ng\u01b0\u1eddi \u0111\u1ea1i di\u1ec7n b\xean A",required:!0,example:"Nguy\u1ec5n V\u0103n A"},{originalText:"Gi\xe1m \u0111\u1ed1c",placeholder:"CHUC_VU_A",type:"text",description:"Ch\u1ee9c v\u1ee5 ng\u01b0\u1eddi \u0111\u1ea1i di\u1ec7n b\xean A",required:!0,example:"Gi\xe1m \u0111\u1ed1c"},{originalText:"10.000.000 VN\u0110",placeholder:"GIA_TRI_HOP_DONG",type:"number",description:"Gi\xe1 tr\u1ecb h\u1ee3p \u0111\u1ed3ng",required:!0,example:"50.000.000 VN\u0110"},{originalText:"01/08/2025",placeholder:"NGAY_BAT_DAU",type:"date",description:"Ng\xe0y b\u1eaft \u0111\u1ea7u h\u1ee3p \u0111\u1ed3ng",required:!0,example:"01/01/2025"}];I(e),h(t=>(0,a.A)((0,a.A)({},t),{},{extractedFields:e})),C(!1)},2e3)}},disabled:j||v}),(0,U.jsx)("label",{htmlFor:"template-upload",children:(0,U.jsx)(r.A,{variant:"outlined",component:"span",startIcon:(0,U.jsx)(ke.A,{}),disabled:j||v,children:c("pages.quotations.templateUpload.file.choose")})}),p.file&&(0,U.jsxs)(l.A,{variant:"body2",sx:{mt:1},children:[c("pages.quotations.templateUpload.file.selected")," ",p.file.name]})]})]}),(0,U.jsx)(o.A,{children:(0,U.jsxs)(u.A,{variant:"outlined",sx:{p:2,height:"100%"},children:[(0,U.jsx)(l.A,{variant:"subtitle1",gutterBottom:!0,children:c("pages.quotations.templateUpload.extracted.title")}),v?(0,U.jsxs)(o.A,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",py:4,children:[(0,U.jsx)(Ce.A,{size:40}),(0,U.jsx)(l.A,{variant:"body2",color:"textSecondary",sx:{mt:2},children:c("pages.quotations.templateUpload.analyzing")})]}):k.length>0?(0,U.jsx)(D.A,{component:u.A,variant:"outlined",children:(0,U.jsxs)(N.A,{size:"small",children:[(0,U.jsx)(T.A,{children:(0,U.jsxs)(z.A,{children:[(0,U.jsx)(E.A,{children:c("pages.quotations.templateUpload.extracted.columns.original")}),(0,U.jsx)(E.A,{children:c("pages.quotations.templateUpload.extracted.columns.placeholder")}),(0,U.jsx)(E.A,{children:c("pages.quotations.templateUpload.extracted.columns.type")}),(0,U.jsx)(E.A,{children:c("pages.quotations.templateUpload.extracted.columns.description")}),(0,U.jsx)(E.A,{align:"center",children:c("pages.quotations.templateUpload.extracted.columns.actions")})]})}),(0,U.jsx)(P.A,{children:k.map((e,t)=>(0,U.jsxs)(z.A,{children:[(0,U.jsx)(E.A,{children:e.originalText}),(0,U.jsx)(E.A,{children:(0,U.jsx)(m.A,{size:"small",value:e.placeholder,onChange:e=>M(t,"placeholder",e.target.value),fullWidth:!0,disabled:j})}),(0,U.jsx)(E.A,{children:(0,U.jsx)(x.A,{fullWidth:!0,size:"small",children:(0,U.jsxs)(A.A,{value:e.type,onChange:e=>M(t,"type",e.target.value),disabled:j,children:[(0,U.jsx)(f.A,{value:"text",children:c("pages.quotations.templateUpload.fieldTypes.text")}),(0,U.jsx)(f.A,{value:"number",children:c("pages.quotations.templateUpload.fieldTypes.number")}),(0,U.jsx)(f.A,{value:"date",children:c("pages.quotations.templateUpload.fieldTypes.date")}),(0,U.jsx)(f.A,{value:"phone",children:c("pages.quotations.templateUpload.fieldTypes.phone")}),(0,U.jsx)(f.A,{value:"email",children:c("pages.quotations.templateUpload.fieldTypes.email")}),(0,U.jsx)(f.A,{value:"taxcode",children:c("pages.quotations.templateUpload.fieldTypes.taxcode")})]})})}),(0,U.jsx)(E.A,{children:(0,U.jsx)(m.A,{size:"small",value:e.description||"",onChange:e=>M(t,"description",e.target.value),fullWidth:!0,disabled:j})}),(0,U.jsx)(E.A,{align:"center",children:(0,U.jsx)(J.A,{size:"small",color:"error",onClick:()=>{const e=[...k];e.splice(t,1),I(e),h(t=>(0,a.A)((0,a.A)({},t),{},{extractedFields:e}))},disabled:j,children:(0,U.jsx)(ae.A,{fontSize:"small"})})})]},t))})]})}):p.file?(0,U.jsx)(l.A,{variant:"body2",color:"textSecondary",children:c("pages.quotations.templateUpload.extracted.empty")}):(0,U.jsx)(l.A,{variant:"body2",color:"textSecondary",children:c("pages.quotations.templateUpload.extracted.needFile")}),(0,U.jsxs)(o.A,{mt:3,children:[(0,U.jsx)(l.A,{variant:"subtitle2",gutterBottom:!0,children:c("pages.quotations.templateUpload.guide.title")}),(0,U.jsxs)(l.A,{variant:"body2",color:"textSecondary",children:["- ",c("pages.quotations.templateUpload.guide.line1"),(0,U.jsx)("br",{}),"- ",c("pages.quotations.templateUpload.guide.line2"),(0,U.jsx)("br",{}),"- ",c("pages.quotations.templateUpload.guide.line3")]})]})]})})]})}),(0,U.jsxs)(W.A,{sx:{p:2,borderTop:1,borderColor:"divider"},children:[(0,U.jsx)(r.A,{onClick:F,disabled:j,children:c("common.cancel")}),(0,U.jsx)(r.A,{type:"submit",variant:"contained",color:"primary",disabled:j||v||0===k.length,startIcon:j?(0,U.jsx)(Ce.A,{size:20}):null,children:c(j?"pages.quotations.templateUpload.actions.uploading":"pages.quotations.templateUpload.actions.saveTemplate")})]})]})]})},Se=["C\xf4ng ty A","C\xf4ng ty B","C\xf4ng ty C","C\xf4ng ty D"],De=[{id:1,name:"Deal A1",customer:"C\xf4ng ty A"},{id:2,name:"Deal A2",customer:"C\xf4ng ty A"},{id:3,name:"Deal B1",customer:"C\xf4ng ty B"},{id:4,name:"Deal C1",customer:"C\xf4ng ty C"}],Ne=[{id:1,name:"Y\xeau c\u1ea7u A1.1",dealId:1,description:"X\xe2y d\u1ef1ng website b\xe1n h\xe0ng cho C\xf4ng ty A",features:[{feature:"Trang ch\u1ee7",detail:"Thi\u1ebft k\u1ebf trang ch\u1ee7 hi\u1ec7n \u0111\u1ea1i",description:"Trang ch\u1ee7 v\u1edbi slider banner, danh m\u1ee5c s\u1ea3n ph\u1ea9m n\u1ed5i b\u1eadt, s\u1ea3n ph\u1ea9m m\u1edbi",notes:"T\xedch h\u1ee3p animation cho banner"},{feature:"Trang s\u1ea3n ph\u1ea9m",detail:"Danh s\xe1ch s\u1ea3n ph\u1ea9m c\xf3 b\u1ed9 l\u1ecdc",description:"Hi\u1ec3n th\u1ecb s\u1ea3n ph\u1ea9m d\u1ea1ng l\u01b0\u1edbi, c\xf3 b\u1ed9 l\u1ecdc theo danh m\u1ee5c, gi\xe1, th\u01b0\u01a1ng hi\u1ec7u",notes:"C\xf3 ch\u1ee9c n\u0103ng so s\xe1nh s\u1ea3n ph\u1ea9m"},{feature:"Gi\u1ecf h\xe0ng",detail:"Ch\u1ee9c n\u0103ng gi\u1ecf h\xe0ng \u0111\u1ea7y \u0111\u1ee7",description:"Th\xeam, s\u1eeda, x\xf3a s\u1ea3n ph\u1ea9m trong gi\u1ecf h\xe0ng, t\xednh t\u1ed5ng ti\u1ec1n",notes:"L\u01b0u gi\u1ecf h\xe0ng v\xe0o localStorage"},{feature:"Thanh to\xe1n",detail:"Quy tr\xecnh thanh to\xe1n",description:"Form nh\u1eadp th\xf4ng tin giao h\xe0ng, ch\u1ecdn ph\u01b0\u01a1ng th\u1ee9c thanh to\xe1n",notes:"T\xedch h\u1ee3p thanh to\xe1n qua VNPay"}]},{id:2,name:"Y\xeau c\u1ea7u A1.2",dealId:1,description:"X\xe2y d\u1ef1ng h\u1ec7 th\u1ed1ng qu\u1ea3n l\xfd kho cho C\xf4ng ty A",features:[{feature:"Qu\u1ea3n l\xfd s\u1ea3n ph\u1ea9m",detail:"CRUD s\u1ea3n ph\u1ea9m",description:"Th\xeam, s\u1eeda, x\xf3a, xem chi ti\u1ebft s\u1ea3n ph\u1ea9m trong kho",notes:"H\u1ed7 tr\u1ee3 import/export Excel"},{feature:"Qu\u1ea3n l\xfd nh\u1eadp kho",detail:"Quy tr\xecnh nh\u1eadp kho",description:"T\u1ea1o phi\u1ebfu nh\u1eadp kho, x\xe1c nh\u1eadn nh\u1eadp kho, c\u1eadp nh\u1eadt s\u1ed1 l\u01b0\u1ee3ng t\u1ed3n",notes:"T\xedch h\u1ee3p v\u1edbi m\xe3 v\u1ea1ch"},{feature:"Qu\u1ea3n l\xfd xu\u1ea5t kho",detail:"Quy tr\xecnh xu\u1ea5t kho",description:"T\u1ea1o phi\u1ebfu xu\u1ea5t kho, x\xe1c nh\u1eadn xu\u1ea5t kho, c\u1eadp nh\u1eadt s\u1ed1 l\u01b0\u1ee3ng t\u1ed3n",notes:"T\u1ef1 \u0111\u1ed9ng xu\u1ea5t kho khi c\xf3 \u0111\u01a1n h\xe0ng"},{feature:"B\xe1o c\xe1o th\u1ed1ng k\xea",detail:"B\xe1o c\xe1o t\u1ed3n kho, nh\u1eadp xu\u1ea5t",description:"B\xe1o c\xe1o t\u1ed3n kho theo th\u1eddi gian, b\xe1o c\xe1o nh\u1eadp xu\u1ea5t theo s\u1ea3n ph\u1ea9m",notes:"Xu\u1ea5t b\xe1o c\xe1o d\u1ea1ng PDF, Excel"}]},{id:3,name:"Y\xeau c\u1ea7u A2.1",dealId:2,description:"X\xe2y d\u1ef1ng app mobile cho C\xf4ng ty A",features:[{feature:"\u0110\u0103ng nh\u1eadp/\u0110\u0103ng k\xfd",detail:"H\u1ec7 th\u1ed1ng x\xe1c th\u1ef1c",description:"\u0110\u0103ng nh\u1eadp b\u1eb1ng email/password, \u0111\u0103ng k\xfd t\xe0i kho\u1ea3n m\u1edbi, qu\xean m\u1eadt kh\u1ea9u",notes:"H\u1ed7 tr\u1ee3 \u0111\u0103ng nh\u1eadp b\u1eb1ng Google, Facebook"},{feature:"Trang c\xe1 nh\xe2n",detail:"Th\xf4ng tin ng\u01b0\u1eddi d\xf9ng",description:"Xem, c\u1eadp nh\u1eadt th\xf4ng tin c\xe1 nh\xe2n, \u0111\u1ed5i m\u1eadt kh\u1ea9u",notes:"Upload avatar"},{feature:"Th\xf4ng b\xe1o",detail:"H\u1ec7 th\u1ed1ng th\xf4ng b\xe1o",description:"Nh\u1eadn th\xf4ng b\xe1o realtime, xem l\u1ecbch s\u1eed th\xf4ng b\xe1o",notes:"S\u1eed d\u1ee5ng Firebase Cloud Messaging"}]},{id:4,name:"Y\xeau c\u1ea7u B1.1",dealId:3,description:"X\xe2y d\u1ef1ng h\u1ec7 th\u1ed1ng Qu\u1ea3n l\xfd Kho cho C\xf4ng ty B",features:[{feature:"Qu\u1ea3n l\xfd Kho",detail:"Nh\u1eadp kho",description:"Cho ph\xe9p ng\u01b0\u1eddi d\xf9ng nh\u1eadp h\xe0ng m\u1edbi v\xe0o kho",notes:"T\u1eeb AI (m\u1eabu)"},{feature:"Qu\u1ea3n l\xfd Kho",detail:"Xu\u1ea5t kho",description:"Ghi nh\u1eadn xu\u1ea5t kho khi giao h\xe0ng ho\u1eb7c b\xe1n",notes:"T\u1eeb AI (m\u1eabu)"},{feature:"Gi\xe1m s\xe1t Kho",detail:"C\u1ea3nh b\xe1o t\u1ed3n kho th\u1ea5p",description:"Th\xf4ng b\xe1o khi s\u1ed1 l\u01b0\u1ee3ng h\xe0ng t\u1ed3n d\u01b0\u1edbi m\u1ee9c t\u1ed1i thi\u1ec3u",notes:"T\u1eeb AI (m\u1eabu)"}]}],Te=e=>Array.from({length:e},(e,t)=>({id:t+1,name:"B\xe1o gi\xe1 ".concat(t+1," - ").concat(["Website b\xe1n h\xe0ng","H\u1ec7 th\u1ed1ng kho","App di \u0111\u1ed9ng","Ph\u1ea7n m\u1ec1m k\u1ebf to\xe1n"][t%4]),customer:Se[Math.floor(Math.random()*Se.length)],dealId:t%4+1,dealName:De[t%4].name,requirementId:t%4+1,requirementName:Ne[t%4].name,status:["draft","sent","approved","rejected"][Math.floor(4*Math.random())],createdDate:new Date(Date.now()-24*Math.floor(90*Math.random())*60*60*1e3).toISOString().split("T")[0],note:"",items:[],totalEffort:Math.floor(100*Math.random())+20,totalAmount:5e5*(Math.floor(100*Math.random())+20)})),ze=[{value:"draft",label:"Draft",color:"default"},{value:"sent",label:"\u0110\xe3 g\u1eedi",color:"info"},{value:"approved",label:"\u0110\xe3 duy\u1ec7t",color:"success"},{value:"rejected",label:"T\u1eeb ch\u1ed1i",color:"error"}],Ee=()=>{const{t:e}=(0,s.Bd)(),[t,n]=(0,i.useState)("quotes"),[y,q]=(0,i.useState)(""),[w,C]=(0,i.useState)(null),[k,I]=(0,i.useState)("all"),[S,D]=(0,i.useState)(0),[N,T]=(0,i.useState)(10),[z,E]=(0,i.useState)(!1),[P,W]=(0,i.useState)([]),[M,F]=(0,i.useState)(!1),[B,R]=(0,i.useState)(null),[V,H]=(0,i.useState)(Te(25)),[O,_]=(0,i.useState)(!1),[L,G]=(0,i.useState)(!1),[Q,X]=(0,i.useState)(null),[Y,J]=(0,i.useState)(!1),[K,Z]=(0,i.useState)(!1),[$,ee]=(0,i.useState)(null);(0,i.useEffect)(()=>{E(!0),H(Te(25));W([{id:"1",name:"M\u1eabu b\xe1o gi\xe1 d\u1ef1 \xe1n ph\u1ea7n m\u1ec1m",description:"Template b\xe1o gi\xe1 d\u1ef1 \xe1n ph\u1ea7n m\u1ec1m ti\xeau chu\u1ea9n",type:"customer",status:"active",createdAt:"2025-06-30T10:00:00Z",updatedAt:"2025-06-30T10:00:00Z",createdBy:"Nguy\u1ec5n V\u0103n A",placeholderCount:8,isDefault:!0,extractedFields:[]},{id:"2",name:"M\u1eabu b\xe1o gi\xe1 d\u1ecbch v\u1ee5 IT",description:"Template b\xe1o gi\xe1 d\u1ecbch v\u1ee5 IT outsourcing",type:"internal",status:"active",createdAt:"2025-06-29T15:30:00Z",updatedAt:"2025-06-29T15:30:00Z",createdBy:"Tr\u1ea7n Th\u1ecb B",placeholderCount:5,isDefault:!1,extractedFields:[]}]),E(!1)},[]);const te=V.filter(e=>{const t=e.name.toLowerCase().includes(y.toLowerCase())||e.customer.toLowerCase().includes(y.toLowerCase()),n=!w||e.customer===w,a="all"===k||e.status===k;return t&&n&&a}),ne=te.slice(S*N,S*N+N);return(0,U.jsxs)(o.A,{sx:{p:3},children:[$&&(0,U.jsx)(qe,{open:K,onClose:()=>Z(!1),onSend:t=>{if(console.log("Sending email:",t),"draft"===(null===$||void 0===$?void 0:$.status)){const e=V.map(e=>e.id===$.id?(0,a.A)((0,a.A)({},e),{},{status:"sent"}):e);H(e)}alert(e("pages.quotations.notifications.emailSent")),Z(!1)},customerName:$.customer,serviceName:$.name,responsiblePerson:e("pages.customers.columns.owner"),pdfFileName:"BaoGia_".concat($.id,".pdf")}),(0,U.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,flexWrap:"wrap",gap:2},children:[(0,U.jsx)(l.A,{variant:"h4",component:"h1",children:e("pages.quotations.title")}),"quotes"===t&&(0,U.jsx)(r.A,{variant:"contained",color:"primary",startIcon:(0,U.jsx)(j.A,{}),onClick:()=>{_(!0)},children:e("pages.quotations.actions.createQuotation")})]}),(0,U.jsx)(o.A,{sx:{borderBottom:1,borderColor:"divider",mb:3},children:(0,U.jsxs)(d.A,{value:t,onChange:(e,t)=>{n(t),D(0)},"aria-label":"quotation management tabs",children:[(0,U.jsx)(c.A,{label:e("pages.quotations.tabs.templates"),value:"templates"}),(0,U.jsx)(c.A,{label:e("pages.quotations.tabs.quotes"),value:"quotes"})]})}),"templates"===t?(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(we,{templates:P,loading:z,onUploadClick:()=>{F(!0)},onViewTemplate:e=>{const t=P.find(t=>t.id===e);t&&(R(t),console.log("Viewing template:",t))},onDeleteTemplate:e=>{W(t=>t.filter(t=>t.id!==e)),console.log("Deleted template with ID:",e)},onDownloadTemplate:e=>{const t=P.find(t=>t.id===e);t&&console.log("Downloading template:",t)}}),(0,U.jsx)(Ie,{open:M,onClose:()=>{F(!1)},onSubmit:async e=>{try{E(!0),console.log("Uploading template:",e),await new Promise(e=>setTimeout(e,1e3));const t={id:"template-".concat(Date.now()),name:e.name,description:e.description,type:e.type,status:"active",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),createdBy:"Ng\u01b0\u1eddi d\xf9ng hi\u1ec7n t\u1ea1i",placeholderCount:Math.floor(10*Math.random())+3,isDefault:!1,extractedFields:[]};W(e=>[t,...e]),F(!1)}catch(t){console.error("Error uploading template:",t)}finally{E(!1)}}})]}):(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(u.A,{sx:{p:2,mb:3},children:(0,U.jsxs)(p.A,{direction:{xs:"column",md:"row"},spacing:2,alignItems:"center",children:[(0,U.jsx)(m.A,{label:e("pages.quotations.searchPlaceholder"),variant:"outlined",size:"small",value:y,onChange:e=>{q(e.target.value),D(0)},sx:{minWidth:200,flex:1},InputProps:{startAdornment:(0,U.jsx)(b.A,{fontSize:"small",sx:{mr:1,color:"text.secondary"}})}}),(0,U.jsx)(h.A,{options:Se,value:w,onChange:(e,t)=>{C(t),D(0)},renderInput:t=>(0,U.jsx)(m.A,(0,a.A)((0,a.A)({},t),{},{label:e("pages.quotations.fields.customer"),size:"small"})),sx:{minWidth:200}}),(0,U.jsxs)(x.A,{size:"small",sx:{minWidth:150},children:[(0,U.jsx)(g.A,{id:"status-filter-label",children:e("pages.quotations.filters.status")}),(0,U.jsxs)(A.A,{labelId:"status-filter-label",value:k,label:e("pages.quotations.filters.status"),onChange:e=>{I(e.target.value),D(0)},children:[(0,U.jsx)(f.A,{value:"all",children:e("pages.quotations.filters.all")}),ze.map(t=>(0,U.jsx)(f.A,{value:t.value,children:e("pages.quotations.status.".concat(t.value))},t.value))]})]}),(0,U.jsx)(r.A,{variant:"outlined",startIcon:(0,U.jsx)(v.A,{}),onClick:()=>console.log("Export data"),children:e("pages.quotations.actions.exportExcel")})]})}),(0,U.jsx)(be,{quotations:ne,onViewDetail:e=>{const t=V.find(t=>t.id===e);t&&(X(t),G(!0))},onDownloadPdf:e=>{const t=V.find(t=>t.id===e);t&&(X(t),J(!0))},onSendEmail:e=>{const t=V.find(t=>t.id===e);t&&(ee(t),Z(!0))},page:S,rowsPerPage:N,onPageChange:(e,t)=>{D(t)},onRowsPerPageChange:e=>{T(parseInt(e.target.value,10)),D(0)},totalCount:te.length})]}),(0,U.jsx)(ue,{open:O,onClose:()=>{_(!1)},onSave:e=>{const t=(0,a.A)((0,a.A)({},e),{},{id:Math.max(...V.map(e=>e.id),0)+1});H([t,...V]),_(!1)},customers:Se,deals:De,requirements:Ne,templates:P}),(0,U.jsx)(ge,{open:L,onClose:()=>G(!1),quotation:Q}),(0,U.jsx)(fe,{open:Y,onClose:()=>J(!1),quotation:Q,onSaveDraft:t=>{const n=V.map(e=>e.id===t.id?t:e);H(n),J(!1),alert(e("pages.quotations.notifications.saveDraftSuccess"))},onExportPdf:t=>{console.log("Export PDF",t),alert(e("pages.quotations.notifications.exportPdfSuccess"))},onEdit:()=>{J(!1)}})]})}}}]);
//# sourceMappingURL=808.edf45109.chunk.js.map