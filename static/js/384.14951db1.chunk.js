"use strict";(self.webpackChunkfe_crm=self.webpackChunkfe_crm||[]).push([[384],{85384:(e,n,l)=>{l.r(n),l.d(n,{default:()=>_e});var t=l(89379),a=l(65043),r=l(53969),s=l(55895),i=l(41859),o=l(94799),d=l(14333),c=l(12843),h=l(64020),x=l(83759),m=l(38517),u=l(81911),A=l(78776),g=l(85877),j=l(22950),p=l(40847),v=l(1422),f=l(81445);let b=function(e){return e.INITIAL_CONTACT="Li\xean h\u1ec7 ban \u0111\u1ea7u",e.REQUIREMENT_RECORDED="\u0110\xe3 ghi nh\u1eadn y\xeau c\u1ea7u",e.QUOTE_SENT="\u0110\xe3 g\u1eedi b\xe1o gi\xe1",e.CONTRACT_SENT="G\u1eedi h\u1ee3p \u0111\u1ed3ng",e.CLOSED_WON="\u0110\xe3 ch\u1ed1t",e.CLOSED_LOST="\u0110\xe3 hu\u1ef7",e}({});const y={[b.INITIAL_CONTACT]:"#ff9800",[b.REQUIREMENT_RECORDED]:"#fbc02d",[b.QUOTE_SENT]:"#1976d2",[b.CONTRACT_SENT]:"#7b1fa2",[b.CLOSED_WON]:"#4caf50",[b.CLOSED_LOST]:"#e53935"},C={[b.INITIAL_CONTACT]:.1,[b.REQUIREMENT_RECORDED]:.3,[b.QUOTE_SENT]:.5,[b.CONTRACT_SENT]:.7,[b.CLOSED_WON]:1,[b.CLOSED_LOST]:0};var D=l(42579),T=l(24343),w=l(33699),S=l(17171),R=l(27421),I=l(70579);const N=["C\xe1c deal ch\u01b0a ch\u1ed1t trong th\xe1ng 7 c\u1ee7a Ph\u1ea1m Th\u1ecb D","Deal gi\xe1 tr\u1ecb tr\xean 100 tri\u1ec7u ch\u01b0a g\u1eedi b\xe1o gi\xe1","Hi\u1ec3n th\u1ecb deal \u0111ang \u1edf giai \u0111o\u1ea1n \u0111\xe0m ph\xe1n","T\xecm deal c\u1ee7a kh\xe1ch h\xe0ng ABC"],E=e=>{let{open:n,onClose:l,onApplyFilter:t,currentFilter:d}=e;const[c,h]=(0,a.useState)(""),[j,p]=(0,a.useState)(!1),f=()=>{c.trim()&&(p(!0),setTimeout(()=>{t(c),p(!1),l()},500))};return(0,I.jsxs)(m.A,{open:n,onClose:l,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:2,minHeight:"400px",display:"flex",flexDirection:"column"}},children:[(0,I.jsxs)(u.A,{sx:{display:"flex",alignItems:"center",borderBottom:"1px solid",borderColor:"divider",padding:2},children:[(0,I.jsx)(v.A,{color:"primary",sx:{mr:1}}),(0,I.jsx)(s.A,{variant:"h6",component:"span",children:"B\u1ed9 l\u1ecdc th\xf4ng minh"}),(0,I.jsx)(D.A,{"aria-label":"close",onClick:l,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,I.jsx)(R.A,{})})]}),(0,I.jsxs)(A.A,{sx:{flex:1,display:"flex",flexDirection:"column"},children:[(0,I.jsxs)(r.A,{sx:{mb:2},children:[(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Nh\u1eadp y\xeau c\u1ea7u l\u1ecdc c\u1ee7a b\u1ea1n b\u1eb1ng ng\xf4n ng\u1eef t\u1ef1 nhi\xean"}),(0,I.jsx)(T.A,{fullWidth:!0,variant:"outlined",placeholder:"V\xed d\u1ee5: C\xe1c deal ch\u01b0a ch\u1ed1t trong th\xe1ng 7",value:c,onChange:e=>h(e.target.value),onKeyPress:e=>"Enter"===e.key&&f(),disabled:j,InputProps:{endAdornment:(0,I.jsx)(w.A,{position:"end",children:(0,I.jsx)(D.A,{onClick:f,disabled:!c.trim()||j,color:"primary",children:(0,I.jsx)(S.A,{})})})}})]}),(0,I.jsxs)(r.A,{sx:{mt:2,mb:2},children:[(0,I.jsx)(s.A,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"G\u1ee3i \xfd t\xecm ki\u1ebfm:"}),(0,I.jsx)(r.A,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:N.map((e,n)=>(0,I.jsx)(x.A,{label:e,onClick:()=>(e=>{h(e)})(e),size:"small",variant:"outlined",sx:{cursor:"pointer"}},n))})]}),d&&(0,I.jsxs)(o.A,{variant:"outlined",sx:{mt:"auto",p:2,bgcolor:"action.hover",borderRadius:1},children:[(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",children:"B\u1ed9 l\u1ecdc hi\u1ec7n t\u1ea1i:"}),(0,I.jsx)(s.A,{variant:"body1",children:d})]})]}),(0,I.jsxs)(g.A,{sx:{p:2,borderTop:"1px solid",borderColor:"divider"},children:[(0,I.jsx)(i.A,{onClick:l,color:"inherit",children:"H\u1ee7y"}),(0,I.jsx)(i.A,{onClick:f,variant:"contained",disabled:!c.trim()||j,startIcon:(0,I.jsx)(S.A,{}),children:j?"\u0110ang x\u1eed l\xfd...":"\xc1p d\u1ee5ng"})]})]})};var O=l(28259),k=l(87443),M=l(10756),W=l(86172),L=l(81341),_=l(34375),z=l(26529),F=l(89174),P=l(4395),G=l(47471),V=l(79801),H=l(66185),B=l(61773),U=l(3665),Q=l(12043),X=l(19817),J=l(5362),K=l(23086),$=l(78255);const Y=e=>{let{stage:n,size:l="medium",showTooltip:t=!1}=e;const a=y[n],s=(0,I.jsx)(r.A,{component:"span",sx:{display:"inline-block",padding:(()=>{switch(l){case"small":return"2px 6px";case"large":return"6px 12px";default:return"4px 8px"}})(),borderRadius:"16px",backgroundColor:((e,n)=>{const l=parseInt(e.slice(1,3),16),t=parseInt(e.slice(3,5),16),a=parseInt(e.slice(5,7),16);return"rgba(".concat(l,", ").concat(t,", ").concat(a,", ").concat(n,")")})(a,.15),color:a,fontSize:(()=>{switch(l){case"small":return"0.75rem";case"large":return"0.95rem";default:return"0.875rem"}})(),fontWeight:500,lineHeight:1.5,textAlign:"center",whiteSpace:"nowrap",verticalAlign:"baseline",transition:"all 0.2s ease-in-out"},children:n});return t?(0,I.jsx)(z.A,{title:"Giai \u0111o\u1ea1n: ".concat(n),arrow:!0,children:s}):s},q=e=>{let{deadline:n,reminderNote:l,size:t="medium"}=e;const a=()=>{const e=new Date(n),l=new Date;l.setHours(0,0,0,0);const t=e.getTime()-l.getTime(),a=Math.ceil(t/864e5);return a<0?"Qu\xe1 h\u1ea1n":0===a?"\u0110\u1ebfn h\u1ea1n h\xf4m nay":"S\u1eafp \u0111\u1ebfn h\u1ea1n trong ".concat(a," ng\xe0y n\u1eefa")};if(!(()=>{const e=new Date(n),l=new Date;l.setHours(0,0,0,0);const t=e.getTime()-l.getTime(),a=Math.ceil(t/864e5);return a>=0&&a<=3})())return null;const s=l?"".concat(a(),". ").concat(l):a();return(0,I.jsx)(z.A,{title:s,arrow:!0,children:(0,I.jsx)(r.A,{component:"span",sx:{ml:1},children:(0,I.jsx)(h.A,{color:"error",variant:"dot",children:(0,I.jsx)(f.A,{fontSize:(()=>{switch(t){case"small":return"small";case"large":return"large";default:return"medium"}})(),color:"error",sx:{animation:"pulse 1.5s infinite"}})})})})};var Z=l(74117);const ee=e=>{let{deals:n,onEdit:l,onDelete:t,onView:i,onDuplicate:d}=e;const{t:c}=(0,Z.Bd)(),[h,x]=(0,a.useState)(0),[m,u]=(0,a.useState)(10),[A,g]=(0,a.useState)(null),[j,p]=(0,a.useState)(null),v=()=>{g(null),p(null)},f=e=>{try{return(0,K.GP)(new Date(e),"dd/MM/yyyy",{locale:$.vi})}catch(n){return c("common.unknown")}},b=n.slice(h*m,h*m+m);return(0,I.jsxs)(o.A,{sx:{width:"100%",overflow:"hidden",mb:3},children:[(0,I.jsx)(O.A,{sx:{maxHeight:600},children:(0,I.jsxs)(k.A,{stickyHeader:!0,"aria-label":"sticky table",children:[(0,I.jsx)(M.A,{children:(0,I.jsxs)(W.A,{children:[(0,I.jsx)(L.A,{children:c("pages.deals.columns.dealName")}),(0,I.jsx)(L.A,{children:c("pages.deals.columns.customer")}),(0,I.jsx)(L.A,{children:c("pages.deals.columns.owner")}),(0,I.jsx)(L.A,{children:c("pages.deals.columns.amount")}),(0,I.jsx)(L.A,{children:c("pages.deals.columns.stage")}),(0,I.jsx)(L.A,{children:c("pages.deals.columns.createdAt")}),(0,I.jsx)(L.A,{children:c("pages.deals.columns.deadline")}),(0,I.jsx)(L.A,{align:"center",children:c("pages.deals.columns.actions")})]})}),(0,I.jsx)(_.A,{children:b.length>0?b.map(e=>{return(0,I.jsxs)(W.A,{hover:!0,children:[(0,I.jsxs)(L.A,{children:[(0,I.jsxs)(r.A,{sx:{display:"flex",alignItems:"center"},children:[(0,I.jsx)(s.A,{variant:"body1",sx:{fontWeight:500},children:e.name}),e.reminderDate&&(0,I.jsx)(q,{deadline:e.reminderDate,reminderNote:e.reminderNote,size:"small"})]}),e.notes&&(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",noWrap:!0,sx:{maxWidth:250},children:e.notes})]}),(0,I.jsx)(L.A,{children:e.customer}),(0,I.jsx)(L.A,{children:e.owner||c("common.unknown")}),(0,I.jsx)(L.A,{children:(n=e.value,new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0}).format(n))}),(0,I.jsx)(L.A,{children:(0,I.jsx)(Y,{stage:e.stage,size:"small",showTooltip:!0})}),(0,I.jsx)(L.A,{children:f(e.createdAt)}),(0,I.jsx)(L.A,{children:e.deadline?f(e.deadline):"-"}),(0,I.jsx)(L.A,{align:"center",children:(0,I.jsxs)(r.A,{sx:{display:"flex",justifyContent:"center"},children:[(0,I.jsx)(z.A,{title:c("common.edit"),children:(0,I.jsx)(D.A,{size:"small",onClick:()=>l(e),children:(0,I.jsx)(B.A,{fontSize:"small"})})}),(0,I.jsx)(z.A,{title:c("common.viewDetails"),children:(0,I.jsx)(D.A,{size:"small",onClick:()=>i(e),children:(0,I.jsx)(U.A,{fontSize:"small"})})}),(0,I.jsx)(D.A,{size:"small",onClick:n=>((e,n)=>{g(e.currentTarget),p(n)})(n,e),children:(0,I.jsx)(Q.A,{fontSize:"small"})})]})})]},e.id);var n}):(0,I.jsx)(W.A,{children:(0,I.jsx)(L.A,{colSpan:7,align:"center",children:(0,I.jsx)(s.A,{variant:"body1",sx:{py:2},children:c("pages.deals.empty")})})})})]})}),(0,I.jsx)(F.A,{rowsPerPageOptions:[5,10,25],component:"div",count:n.length,rowsPerPage:m,page:h,onPageChange:(e,n)=>{x(n)},onRowsPerPageChange:e=>{u(parseInt(e.target.value,10)),x(0)},labelRowsPerPage:c("pages.deals.pagination.rowsPerPage"),labelDisplayedRows:e=>{let{from:n,to:l,count:t}=e;return c("pages.deals.pagination.displayedRows",{from:n,to:l,count:t})}}),(0,I.jsxs)(P.A,{anchorEl:A,open:Boolean(A),onClose:v,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[(0,I.jsxs)(G.A,{onClick:()=>{j&&d(j),v()},children:[(0,I.jsx)(V.A,{children:(0,I.jsx)(X.A,{fontSize:"small"})}),(0,I.jsx)(H.A,{children:c("pages.deals.ui.contextMenu.duplicate")})]}),(0,I.jsxs)(G.A,{onClick:()=>{j&&t(j.id),v()},children:[(0,I.jsx)(V.A,{children:(0,I.jsx)(J.A,{fontSize:"small",color:"error"})}),(0,I.jsx)(H.A,{sx:{color:"error.main"},children:c("pages.deals.ui.contextMenu.delete")})]})]})]})};var ne=l(10256),le=l(3353),te=l(67203),ae=l(19e3),re=l(48640),se=l(83542),ie=l(92292),oe=l(24793),de=l(63745),ce=l(78916);const he=e=>{var n,l,d,c;let{onFilterChange:h,initialFilters:x}=e;const m=(0,a.useMemo)(()=>({searchTerm:"",stage:"T\u1ea5t c\u1ea3",owner:"T\u1ea5t c\u1ea3",dateRange:null,hasReminder:null,valueRange:{min:0,max:1e9}}),[]),[u,A]=(0,a.useState)(()=>{var e,n,l,a,r,s;return(0,t.A)((0,t.A)((0,t.A)({},m),x),{},{dateRange:null!==(e=null===x||void 0===x?void 0:x.dateRange)&&void 0!==e?e:null,valueRange:{min:null!==(n=null===x||void 0===x||null===(l=x.valueRange)||void 0===l?void 0:l.min)&&void 0!==n?n:m.valueRange.min,max:null!==(a=null===x||void 0===x||null===(r=x.valueRange)||void 0===r?void 0:r.max)&&void 0!==a?a:m.valueRange.max},hasReminder:null!==(s=null===x||void 0===x?void 0:x.hasReminder)&&void 0!==s?s:null})}),g=(0,a.useRef)(void 0),j=(0,a.useCallback)((e,n)=>{g.current&&clearTimeout(g.current),g.current=setTimeout(e,n)},[]),[v,f]=(0,a.useState)(!1),[y,C]=(0,a.useState)([u.valueRange.min,u.valueRange.max]);(0,a.useEffect)(()=>{if(x){var e,n,l,a,r,s;const i=(0,t.A)((0,t.A)((0,t.A)({},m),x),{},{dateRange:null!==(e=x.dateRange)&&void 0!==e?e:null,valueRange:{min:null!==(n=null===(l=x.valueRange)||void 0===l?void 0:l.min)&&void 0!==n?n:m.valueRange.min,max:null!==(a=null===(r=x.valueRange)||void 0===r?void 0:r.max)&&void 0!==a?a:m.valueRange.max},hasReminder:null!==(s=x.hasReminder)&&void 0!==s?s:null});A(i),C([i.valueRange.min,i.valueRange.max])}},[x,m]);const S=(e,n)=>{const l=u.dateRange||{start:null,end:null};if(null===n&&"end"===e&&null===l.start)return;const a=(0,t.A)((0,t.A)({},l),{},{[e]:n}),r=null===a.start&&null===a.end?null:a,s=(0,t.A)((0,t.A)({},u),{},{dateRange:r});A(s),j(()=>{h(s)},300)};(0,a.useEffect)(()=>()=>{g.current&&clearTimeout(g.current)},[]);const R=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0}).format(e),N=[{value:"T\u1ea5t c\u1ea3",label:"T\u1ea5t c\u1ea3 giai \u0111o\u1ea1n"},{value:b.INITIAL_CONTACT,label:"Li\xean h\u1ec7 ban \u0111\u1ea7u"},{value:b.REQUIREMENT_RECORDED,label:"\u0110\xe3 ghi nh\u1eadn y\xeau c\u1ea7u"},{value:b.QUOTE_SENT,label:"\u0110\xe3 g\u1eedi b\xe1o gi\xe1"},{value:b.CONTRACT_SENT,label:"\u0110\xe3 g\u1eedi h\u1ee3p \u0111\u1ed3ng"},{value:b.CLOSED_WON,label:"\u0110\xe3 ch\u1ed1t"},{value:b.CLOSED_LOST,label:"\u0110\xe3 h\u1ee7y"}];return(0,I.jsxs)(o.A,{sx:{p:2,mb:3},children:[(0,I.jsxs)(r.A,{sx:{mb:2,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,I.jsx)(s.A,{variant:"h6",component:"div",children:"T\xecm ki\u1ebfm Deal"}),(0,I.jsx)(i.A,{startIcon:(0,I.jsx)(p.A,{}),onClick:()=>f(!v),color:"primary",children:v?"\u1ea8n b\u1ed9 l\u1ecdc n\xe2ng cao":"B\u1ed9 l\u1ecdc n\xe2ng cao"})]}),(0,I.jsxs)(r.A,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"repeat(2, 1fr)"},gap:2,mb:2},children:[(0,I.jsx)(r.A,{children:(0,I.jsx)(T.A,{fullWidth:!0,name:"searchTerm",label:"T\xecm ki\u1ebfm theo t\xean, m\xf4 t\u1ea3...",value:u.searchTerm,onChange:e=>{const{name:n,value:l}=e.target,a=(0,t.A)((0,t.A)({},u),{},{[n]:l});A(a),j(()=>{h(a)},500)},InputProps:{startAdornment:(0,I.jsx)(w.A,{position:"start",children:(0,I.jsx)(de.A,{})}),endAdornment:u.searchTerm?(0,I.jsx)(w.A,{position:"end",children:(0,I.jsx)(D.A,{size:"small",onClick:()=>A(e=>(0,t.A)((0,t.A)({},e),{},{searchTerm:""})),children:(0,I.jsx)(ce.A,{fontSize:"small"})})}):null}})}),(0,I.jsx)(r.A,{children:(0,I.jsxs)(ne.A,{fullWidth:!0,children:[(0,I.jsx)(le.A,{id:"stage-select-label",children:"Giai \u0111o\u1ea1n"}),(0,I.jsx)(te.A,{labelId:"stage-select-label",name:"stage",value:u.stage,label:"Giai \u0111o\u1ea1n",onChange:e=>{const{name:n,value:l}=e.target,a=(0,t.A)((0,t.A)({},u),{},{[n]:l});A(a),j(()=>{h(a)},300)},children:N.map(e=>(0,I.jsx)(G.A,{value:e.value,children:e.label},e.value))})]})}),(0,I.jsx)(r.A,{sx:{display:"flex",alignItems:"center",gridColumn:{xs:"1 / -1",md:"auto"}}})]}),(0,I.jsx)(ae.A,{in:v,children:(0,I.jsx)(r.A,{sx:{mt:3},children:(0,I.jsxs)(r.A,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"repeat(2, 1fr)"},gap:2},children:[(0,I.jsxs)(r.A,{sx:{gridColumn:"1 / -1"},children:[(0,I.jsx)(s.A,{gutterBottom:!0,children:"Gi\xe1 tr\u1ecb Deal"}),(0,I.jsxs)(r.A,{sx:{px:2},children:[(0,I.jsx)(re.Ay,{value:y,onChange:(e,n)=>{const l=n;C(l);const a=(0,t.A)((0,t.A)({},u),{},{valueRange:{min:l[0],max:l[1]}});A(a),j(()=>{h(a)},500)},onChangeCommitted:()=>{j(()=>{h((0,t.A)((0,t.A)({},u),{},{valueRange:{min:y[0],max:y[1]}}))},0)},valueLabelDisplay:"auto",valueLabelFormat:e=>R(e),min:0,max:1e9,step:1e7}),(0,I.jsxs)(r.A,{sx:{display:"flex",justifyContent:"space-between",mt:1},children:[(0,I.jsx)(s.A,{variant:"body2",children:R(y[0])}),(0,I.jsx)(s.A,{variant:"body2",children:R(y[1])})]})]})]}),(0,I.jsx)(r.A,{children:(0,I.jsx)(oe.$J,{dateAdapter:ie.h,children:(0,I.jsx)(se.l,{label:"T\u1eeb ng\xe0y",value:(null===(n=u.dateRange)||void 0===n?void 0:n.start)||null,onChange:e=>S("start",e),slotProps:{textField:{fullWidth:!0}}})})}),(0,I.jsx)(r.A,{children:(0,I.jsx)(oe.$J,{dateAdapter:ie.h,children:(0,I.jsx)(se.l,{label:"\u0110\u1ebfn ng\xe0y",value:(null===(l=u.dateRange)||void 0===l?void 0:l.end)||null,onChange:e=>S("end",e),slotProps:{textField:{fullWidth:!0}},minDate:(null===(d=u.dateRange)||void 0===d?void 0:d.start)||void 0,disabled:!(null!==(c=u.dateRange)&&void 0!==c&&c.start)})})}),(0,I.jsxs)(r.A,{sx:{gridColumn:"1 / -1",display:"flex",justifyContent:"flex-end",mt:2},children:[(0,I.jsx)(i.A,{variant:"outlined",color:"secondary",onClick:()=>{const e=(0,t.A)((0,t.A)({},m),{},{dateRange:null,hasReminder:null});A(e),C([m.valueRange.min,m.valueRange.max]),g.current&&clearTimeout(g.current),h(e)},startIcon:(0,I.jsx)(ce.A,{}),sx:{mr:1},children:"X\xf3a b\u1ed9 l\u1ecdc"}),(0,I.jsx)(i.A,{variant:"contained",color:"primary",onClick:()=>{h((0,t.A)((0,t.A)({},u),{},{valueRange:{min:y[0],max:y[1]}}))},startIcon:(0,I.jsx)(de.A,{}),children:"\xc1p d\u1ee5ng"})]})]})})})]})};var xe=l(94527),me=l(22947),ue=l(1725),Ae=l(85030);const ge=e=>{let{open:n,onClose:l,onSubmit:o,initialData:d,title:c="Th\xeam Deal m\u1edbi"}=e;const h=(0,a.useMemo)(()=>({name:"",customer:"",value:0,stage:b.INITIAL_CONTACT,notes:"",deadline:"",owner:"",hasReminder:!1,reminderDate:void 0,reminderNote:""}),[]),[x,j]=(0,a.useState)(h),[p,v]=(0,a.useState)({});(0,a.useEffect)(()=>{j(d?{name:d.name,customer:d.customer,value:d.value,stage:d.stage,notes:d.notes||"",deadline:d.deadline||"",owner:d.owner||"",hasReminder:!!d.reminderDate,reminderDate:d.reminderDate,reminderNote:d.reminderNote||""}:h),v({})},[d,h]);const f=e=>{const{name:n,value:l}=e.target;j(e=>(0,t.A)((0,t.A)({},e),{},{[n]:l})),p[n]&&v(e=>(0,t.A)((0,t.A)({},e),{},{[n]:""}))},y=(e,n)=>{j(l=>(0,t.A)((0,t.A)({},l),{},{[e]:(null===n||void 0===n?void 0:n.toISOString())||""})),p[e]&&v(n=>(0,t.A)((0,t.A)({},n),{},{[e]:""}))},C=[{value:b.INITIAL_CONTACT,label:"Li\xean h\u1ec7 ban \u0111\u1ea7u"},{value:b.REQUIREMENT_RECORDED,label:"\u0110\xe3 ghi nh\u1eadn y\xeau c\u1ea7u"},{value:b.QUOTE_SENT,label:"\u0110\xe3 g\u1eedi b\xe1o gi\xe1"},{value:b.CONTRACT_SENT,label:"G\u1eedi h\u1ee3p \u0111\u1ed3ng"},{value:b.CLOSED_WON,label:"\u0110\xe3 ch\u1ed1t"},{value:b.CLOSED_LOST,label:"\u0110\xe3 hu\u1ef7"}];return(0,I.jsxs)(m.A,{open:n,onClose:l,maxWidth:"md",fullWidth:!0,children:[(0,I.jsx)(u.A,{children:(0,I.jsx)(r.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:(0,I.jsx)(s.A,{variant:"h6",children:c})})}),(0,I.jsx)(xe.A,{}),(0,I.jsx)(A.A,{children:(0,I.jsx)("form",{onSubmit:e=>{e.preventDefault(),(()=>{const e={};return x.name.trim()||(e.name="Vui l\xf2ng nh\u1eadp t\xean deal"),x.customer.trim()||(e.customer="Vui l\xf2ng nh\u1eadp t\xean kh\xe1ch h\xe0ng"),x.value<=0&&(e.value="Gi\xe1 tr\u1ecb deal ph\u1ea3i l\u1edbn h\u01a1n 0"),x.hasReminder&&!x.reminderDate&&(e.reminderDate="Vui l\xf2ng ch\u1ecdn ng\xe0y nh\u1eafc vi\u1ec7c"),v(e),0===Object.keys(e).length})()&&o(x)},children:(0,I.jsxs)(r.A,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"repeat(2, 1fr)"},gap:2,py:2},children:[(0,I.jsx)(r.A,{sx:{gridColumn:"1 / -1"},children:(0,I.jsx)(s.A,{variant:"subtitle1",fontWeight:"bold",gutterBottom:!0,children:"Th\xf4ng tin c\u01a1 b\u1ea3n"})}),(0,I.jsx)(r.A,{children:(0,I.jsx)(T.A,{fullWidth:!0,label:"T\xean Deal *",name:"name",value:x.name,onChange:f,error:!!p.name,helperText:p.name})}),(0,I.jsx)(r.A,{children:(0,I.jsx)(T.A,{fullWidth:!0,label:"Kh\xe1ch h\xe0ng *",name:"customer",value:x.customer,onChange:f,error:!!p.customer,helperText:p.customer})}),(0,I.jsx)(r.A,{children:(0,I.jsx)(T.A,{fullWidth:!0,label:"Gi\xe1 tr\u1ecb Deal *",name:"value",type:"number",value:x.value,onChange:f,InputProps:{startAdornment:(0,I.jsx)(w.A,{position:"start",children:"\u0111"})},error:!!p.value,helperText:p.value})}),(0,I.jsx)(r.A,{children:(0,I.jsxs)(ne.A,{fullWidth:!0,error:!!p.stage,children:[(0,I.jsx)(le.A,{id:"stage-select-label",children:"Giai \u0111o\u1ea1n *"}),(0,I.jsx)(te.A,{labelId:"stage-select-label",name:"stage",value:x.stage,label:"Giai \u0111o\u1ea1n *",onChange:e=>{const{name:n,value:l}=e.target;j(e=>(0,t.A)((0,t.A)({},e),{},{[n]:l}))},children:C.map(e=>(0,I.jsx)(G.A,{value:e.value,children:e.label},e.value))}),p.stage&&(0,I.jsx)(me.A,{children:p.stage})]})}),(0,I.jsx)(r.A,{children:(0,I.jsx)(T.A,{fullWidth:!0,label:"Ch\u1ee7 s\u1edf h\u1eefu *",name:"owner",value:x.owner,onChange:f,error:!!p.owner,helperText:p.owner})}),(0,I.jsx)(r.A,{sx:{gridColumn:"1 / -1"},children:(0,I.jsx)(T.A,{fullWidth:!0,label:"M\xf4 t\u1ea3",name:"notes",value:x.notes,onChange:f,multiline:!0,rows:3})}),(0,I.jsx)(r.A,{children:(0,I.jsx)(oe.$J,{dateAdapter:ie.h,children:(0,I.jsx)(se.l,{label:"H\u1ea1n ch\u1ed1t",value:x.deadline?new Date(x.deadline):null,onChange:e=>y("deadline",e),slotProps:{textField:{fullWidth:!0}}})})}),(0,I.jsxs)(r.A,{sx:{gridColumn:"1 / -1",mt:2},children:[(0,I.jsx)(xe.A,{}),(0,I.jsxs)(r.A,{sx:{display:"flex",alignItems:"center",mt:2},children:[(0,I.jsx)(s.A,{variant:"subtitle1",fontWeight:"bold",children:"Nh\u1eafc vi\u1ec7c"}),(0,I.jsx)(ue.A,{control:(0,I.jsx)(Ae.A,{checked:x.hasReminder,onChange:e=>{const n=e.target.checked;j(e=>(0,t.A)((0,t.A)({},e),{},{hasReminder:n,reminderDate:n?e.reminderDate:void 0,reminderNote:n?e.reminderNote:""}))},color:"primary"}),label:x.hasReminder?"\u0110\xe3 b\u1eadt":"T\u1eaft",sx:{ml:2}})]})]}),x.hasReminder&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(r.A,{children:(0,I.jsx)(oe.$J,{dateAdapter:ie.h,children:(0,I.jsx)(se.l,{label:"Ng\xe0y nh\u1eafc vi\u1ec7c *",value:x.reminderDate?new Date(x.reminderDate):null,onChange:e=>y("reminderDate",e),slotProps:{textField:{fullWidth:!0,error:!!p.reminderDate,helperText:p.reminderDate}},minDate:new Date})})}),(0,I.jsx)(r.A,{sx:{gridColumn:"1 / -1"},children:(0,I.jsx)(T.A,{fullWidth:!0,label:"Ghi ch\xfa nh\u1eafc vi\u1ec7c",name:"reminderNote",value:x.reminderNote,onChange:f,multiline:!0,rows:3})})]})]})})}),(0,I.jsx)(xe.A,{}),(0,I.jsxs)(g.A,{sx:{px:3,py:2},children:[(0,I.jsx)(i.A,{onClick:l,variant:"outlined",color:"inherit",children:"H\u1ee7y"}),(0,I.jsx)(i.A,{type:"submit",form:"deal-form",variant:"contained",color:"primary",children:d?"C\u1eadp nh\u1eadt":"Th\xeam m\u1edbi"})]})]})};var je=l(91244),pe=l(16128),ve=l(53974),fe=l(82518),be=l(69200),ye=l(93201),Ce=l(63898),De=l(72842);const Te=e=>{let{deals:n}=e;const l=(()=>{const e=new Date,l=e.getMonth(),t=e.getFullYear(),a={totalDealAmount:0,weightedDealAmount:0,openDealAmount:0,closedDealAmount:0,newDealsThisMonth:0,totalDealAgeInDays:0,dealCount:0};n.forEach(n=>{a.totalDealAmount+=n.value;const r=n.stage;a.weightedDealAmount+=n.value*C[r],r===b.CLOSED_WON?a.closedDealAmount+=n.value:r!==b.CLOSED_LOST&&(a.openDealAmount+=n.value);const s=new Date(n.createdAt);s.getMonth()===l&&s.getFullYear()===t&&a.newDealsThisMonth++;const i=new Date(n.createdAt).getTime(),o=e.getTime(),d=Math.floor((o-i)/864e5);a.totalDealAgeInDays+=d,a.dealCount++});const r=a.dealCount>0?Math.round(a.totalDealAgeInDays/a.dealCount):0;return{totalDealAmount:a.totalDealAmount,weightedDealAmount:a.weightedDealAmount,openDealAmount:a.openDealAmount,closedDealAmount:a.closedDealAmount,newDealsThisMonth:a.newDealsThisMonth,averageDealAge:r}})(),t=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0}).format(e),a=[{title:"T\u1ed5ng gi\xe1 tr\u1ecb Deal",value:t(l.totalDealAmount),icon:(0,I.jsx)(ve.A,{fontSize:"large",sx:{color:"#1976d2"}})},{title:"T\u1ed5ng gi\xe1 tr\u1ecb Deal c\xf3 tr\u1ecdng s\u1ed1",value:t(l.weightedDealAmount),icon:(0,I.jsx)(fe.A,{fontSize:"large",sx:{color:"#7b1fa2"}})},{title:"Gi\xe1 tr\u1ecb Deal \u0111ang m\u1edf",value:t(l.openDealAmount),icon:(0,I.jsx)(be.A,{fontSize:"large",sx:{color:"#ff9800"}})},{title:"Gi\xe1 tr\u1ecb Deal \u0111\xe3 ch\u1ed1t",value:t(l.closedDealAmount),icon:(0,I.jsx)(ye.A,{fontSize:"large",sx:{color:"#4caf50"}})},{title:"S\u1ed1 Deal m\u1edbi trong th\xe1ng",value:"".concat(l.newDealsThisMonth," deal"),icon:(0,I.jsx)(Ce.A,{fontSize:"large",sx:{color:"#f57c00"}})},{title:"Tu\u1ed5i trung b\xecnh Deal",value:"".concat(l.averageDealAge," ng\xe0y"),icon:(0,I.jsx)(De.A,{fontSize:"large",sx:{color:"#d32f2f"}})}];return(0,I.jsx)(r.A,{sx:{mb:3},children:(0,I.jsx)(r.A,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr",md:"1fr 1fr 1fr",lg:"repeat(6, 1fr)"},gap:2},children:a.map((e,n)=>(0,I.jsx)(je.A,{sx:{height:"100%",boxShadow:2},children:(0,I.jsxs)(pe.A,{children:[(0,I.jsxs)(r.A,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.icon,(0,I.jsx)(s.A,{variant:"h6",component:"div",sx:{ml:1,fontWeight:500},children:e.title})]}),(0,I.jsx)(s.A,{variant:"h5",component:"div",sx:{fontWeight:"bold",mt:1},children:e.value})]})},"stat-item-".concat(n)))})})};var we=l(60267),Se=l(7240),Re=l(95315),Ie=l(57401),Ne=l(52912),Ee=l(36131),Oe=l(85465),ke=l(61662),Me=l(28344),We=l(4178);const Le=e=>{let{deals:n,onViewDeal:l,onEditDeal:o,onMarkComplete:d,onStageChange:c,onRemindersCountChange:j}=e;const p=(0,we.A)(),[v,y]=(0,a.useState)(null),[C,w]=(0,a.useState)(!1),[S,N]=(0,a.useState)(""),[E,O]=(0,a.useState)(!1),k=(0,a.useMemo)(()=>{const e=new Date;return n.filter(n=>{if(!n.deadline&&!n.reminderDate)return!1;const l=n.deadline?new Date(n.deadline):null,t=n.reminderDate?new Date(n.reminderDate):null,a=l?(0,ke.c)(l,e):1/0,r=t?(0,ke.c)(t,e):1/0;return(a>=0&&a<=7||r>=0&&r<=7)&&n.stage!==b.CLOSED_WON&&n.stage!==b.CLOSED_LOST}).map(n=>{const l=n.deadline?new Date(n.deadline):null,a=l?(0,ke.c)(l,e):1/0;return(0,t.A)((0,t.A)({},n),{},{daysUntilDeadline:a})}).sort((e,n)=>e.daysUntilDeadline-n.daysUntilDeadline)},[n]),M=()=>{w(!1),y(null)},W=e=>{if(!e)return"";const n="string"===typeof e?new Date(e):e;return(0,Me.c)(n)?"H\xf4m nay":(0,We.e)(n)?"Ng\xe0y mai":(0,K.GP)(n,"dd/MM/yyyy",{locale:$.vi})};return 0===k.length?(0,I.jsxs)(je.A,{variant:"outlined",sx:{height:"100%",display:"flex",flexDirection:"column"},children:[(0,I.jsx)(Se.A,{title:(0,I.jsxs)(r.A,{sx:{display:"flex",alignItems:"center"},children:[(0,I.jsx)(f.A,{sx:{mr:1,color:p.palette.text.secondary}}),(0,I.jsx)(s.A,{variant:"h6",children:"Nh\u1eafc vi\u1ec7c"})]})}),(0,I.jsx)(xe.A,{}),(0,I.jsx)(pe.A,{sx:{flexGrow:1,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,I.jsx)(s.A,{variant:"body1",color:"text.secondary",align:"center",children:"Kh\xf4ng c\xf3 nh\u1eafc vi\u1ec7c n\xe0o trong 7 ng\xe0y t\u1edbi"})})]}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(je.A,{variant:"outlined",sx:{height:"100%",display:"flex",flexDirection:"column"},children:[(0,I.jsx)(Se.A,{title:(0,I.jsxs)(r.A,{sx:{display:"flex",alignItems:"center"},children:[(0,I.jsx)(h.A,{badgeContent:k.length,color:"error",sx:{mr:1},children:(0,I.jsx)(Ee.A,{color:"primary"})}),(0,I.jsx)(s.A,{variant:"h6",children:"Nh\u1eafc vi\u1ec7c"})]}),action:(0,I.jsx)(z.A,{title:"Xem t\u1ea5t c\u1ea3 nh\u1eafc vi\u1ec7c",children:(0,I.jsx)(D.A,{size:"small",children:(0,I.jsx)(Q.A,{})})})}),(0,I.jsx)(xe.A,{}),(0,I.jsx)(pe.A,{sx:{p:0,flexGrow:1,overflow:"auto",maxHeight:400},children:(0,I.jsx)(Re.A,{disablePadding:!0,children:k.map((e,n)=>{const l=e.daysUntilDeadline<=2;return(0,I.jsxs)(a.Fragment,{children:[n>0&&(0,I.jsx)(xe.A,{}),(0,I.jsxs)(Ie.Ay,{component:"div",onClick:()=>(e=>{y(e),N(e.reminderNote||""),O(!1),w(!0)})(e),sx:{py:1.5,backgroundColor:l?"error.50":"inherit",cursor:"pointer","&:hover":{backgroundColor:l?"error.100":"action.hover"}},children:[(0,I.jsx)(V.A,{sx:{minWidth:40},children:(0,I.jsx)(f.A,{color:l?"error":"action",sx:{animation:l?"pulse 1.5s infinite":"none"}})}),(0,I.jsx)(H.A,{primary:(0,I.jsx)(s.A,{variant:"body1",noWrap:!0,children:e.name}),secondary:(0,I.jsxs)(r.A,{sx:{display:"flex",flexDirection:"column",mt:.5},children:[(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",noWrap:!0,children:e.customer}),(0,I.jsx)(r.A,{sx:{display:"flex",alignItems:"center",mt:.5,flexWrap:"wrap",gap:.5},children:(0,I.jsx)(x.A,{label:(0,I.jsxs)(s.A,{variant:"caption",children:["H\u1ea1n ch\u1ed1t: ",W(e.deadline)]}),size:"small",color:l?"error":"default",variant:"outlined"})})]}),primaryTypographyProps:{variant:"body1"},secondaryTypographyProps:{component:"div"}}),(0,I.jsx)(Ne.A,{sx:{display:"flex",alignItems:"center",gap:1},children:(0,I.jsx)(te.A,{value:e.stage,onChange:n=>{c&&c(e.id,n.target.value)},size:"small",sx:{minWidth:150,"& .MuiSelect-select":{py:.5,display:"flex",alignItems:"center"}},renderValue:e=>(0,I.jsx)(Y,{stage:e,size:"small",showTooltip:!1}),children:Object.values(b).map(e=>(0,I.jsxs)(G.A,{value:e,children:[(0,I.jsx)(Y,{stage:e,size:"small",showTooltip:!1}),(0,I.jsx)(r.A,{component:"span",sx:{ml:1},children:e})]},e))})})]})]},e.id)})})})]}),(0,I.jsx)(m.A,{open:C,onClose:M,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:v&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(u.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[(0,I.jsx)(s.A,{variant:"h6",children:"Chi ti\u1ebft nh\u1eafc vi\u1ec7c"}),(0,I.jsx)(D.A,{onClick:M,size:"small",children:(0,I.jsx)(R.A,{})})]}),(0,I.jsx)(xe.A,{}),(0,I.jsxs)(A.A,{sx:{py:2},children:[(0,I.jsxs)(r.A,{sx:{mb:2},children:[(0,I.jsx)(s.A,{variant:"subtitle1",fontWeight:"bold",children:v.name}),(0,I.jsxs)(s.A,{variant:"body2",color:"text.secondary",children:["Kh\xe1ch h\xe0ng: ",v.customer]})]}),(0,I.jsxs)(r.A,{sx:{display:"flex",flexWrap:"wrap",gap:1,mb:2},children:[(0,I.jsx)(Y,{stage:v.stage}),(0,I.jsx)(x.A,{label:"Gi\xe1 tr\u1ecb: ".concat(v.value.toLocaleString("vi-VN")," VND"),variant:"outlined"})]}),(0,I.jsx)(r.A,{sx:{mb:2},children:(0,I.jsxs)(s.A,{variant:"body2",children:[(0,I.jsx)("strong",{children:"H\u1ea1n ch\u1ed1t:"})," ",W(v.deadline),v.daysUntilDeadline<=3&&(0,I.jsx)(x.A,{label:"C\xf2n ".concat(v.daysUntilDeadline," ng\xe0y"),color:"error",size:"small",sx:{ml:1}})]})}),v.notes&&(0,I.jsxs)(r.A,{sx:{mb:2},children:[(0,I.jsx)(s.A,{variant:"body2",children:(0,I.jsx)("strong",{children:"Ghi ch\xfa:"})}),(0,I.jsx)(s.A,{variant:"body2",sx:{whiteSpace:"pre-wrap"},children:v.notes})]}),(0,I.jsx)(xe.A,{sx:{my:2}}),(0,I.jsxs)(r.A,{children:[(0,I.jsx)(s.A,{variant:"subtitle2",gutterBottom:!0,children:"Ghi ch\xfa nh\u1eafc vi\u1ec7c:"}),(0,I.jsx)(T.A,{fullWidth:!0,multiline:!0,rows:3,value:S,onChange:e=>N(e.target.value),placeholder:"Th\xeam ghi ch\xfa cho nh\u1eafc vi\u1ec7c n\xe0y...",variant:"outlined",size:"small"})]}),(0,I.jsx)(r.A,{sx:{mt:2},children:(0,I.jsx)(ue.A,{control:(0,I.jsx)(Ae.A,{checked:E,onChange:e=>O(e.target.checked)}),label:"\u0110\xe1nh d\u1ea5u \u0111\xe3 ho\xe0n th\xe0nh"})})]}),(0,I.jsx)(xe.A,{}),(0,I.jsxs)(g.A,{sx:{px:3,py:2},children:[(0,I.jsx)(i.A,{startIcon:(0,I.jsx)(J.A,{}),color:"inherit",onClick:M,children:"\u0110\xf3ng"}),(0,I.jsx)(i.A,{startIcon:(0,I.jsx)(B.A,{}),variant:"outlined",color:"primary",onClick:()=>{o(v.id),M()},children:"Ch\u1ec9nh s\u1eeda Deal"}),(0,I.jsx)(i.A,{startIcon:(0,I.jsx)(Oe.A,{}),variant:"contained",color:"primary",onClick:()=>{v&&(d(v.id),M())},disabled:!E,children:"Ho\xe0n th\xe0nh"})]})]})})]})},_e=()=>{const{t:e}=(0,Z.Bd)(),[n,l]=(0,a.useState)(()=>(e=>{const n=Object.values(b),l=["Nguy\u1ec5n V\u0103n A","Tr\u1ea7n Th\u1ecb B","L\xea V\u0103n C","Ph\u1ea1m Th\u1ecb D"];return Array.from({length:e},(e,t)=>({id:t+1,name:"Deal ".concat(t+1),customer:"C\xf4ng ty ".concat(String.fromCharCode(65+t%5)),stage:n[Math.floor(Math.random()*n.length)],value:Math.floor(1e8*Math.random())+1e7,deadline:new Date(Date.now()+24*Math.floor(30*Math.random())*60*60*1e3).toISOString(),owner:l[Math.floor(Math.random()*l.length)],notes:"Ghi ch\xfa cho deal ".concat(t+1),createdAt:(new Date).toISOString(),hasReminder:Math.random()>.5,reminderNote:Math.random()>.7?"Nh\u1eafc nh\u1edf cho deal ".concat(t+1):void 0,reminderDate:Math.random()>.7?new Date(Date.now()+30*Math.random()*24*60*60*1e3).toISOString():void 0,reminderRecipient:Math.random()>.7?"email".concat(t+1,"@example.com"):void 0}))})(20)),[y,C]=(0,a.useState)({searchTerm:"",stage:"T\u1ea5t c\u1ea3",owner:"T\u1ea5t c\u1ea3",dateRange:null,hasReminder:null,valueRange:{min:0,max:1e9}}),D=(0,a.useMemo)(()=>n.filter(e=>{var n,l,t;const a=!y.searchTerm||e.name.toLowerCase().includes(y.searchTerm.toLowerCase())||e.customer.toLowerCase().includes(y.searchTerm.toLowerCase()),r="T\u1ea5t c\u1ea3"===y.stage||e.stage===y.stage,s="T\u1ea5t c\u1ea3"===y.owner||e.owner===y.owner,i=e.value>=((null===(n=y.valueRange)||void 0===n?void 0:n.min)||0)&&e.value<=((null===(l=y.valueRange)||void 0===l?void 0:l.max)||Number.MAX_SAFE_INTEGER);let o=!0;if(null!==(t=y.dateRange)&&void 0!==t&&t.start){const n=new Date(y.dateRange.start);n.setHours(0,0,0,0);const l=new Date(e.deadline);l.setHours(0,0,0,0),o=l>=n}const d=null===y.hasReminder||(y.hasReminder?e.hasReminder:!e.hasReminder);return a&&r&&s&&i&&o&&d}),[n,y]),[T,w]=(0,a.useState)(!1),[S,R]=(0,a.useState)(null),[N,O]=(0,a.useState)(!1),[k,M]=(0,a.useState)(null),[W,L]=(0,a.useState)(0),[_,z]=(0,a.useState)(0),[F,P]=(0,a.useState)(!1),[G,V]=(0,a.useState)(""),H=(0,a.useCallback)(e=>{const n=new Date;return e.filter(e=>{if(!e.deadline&&!e.reminderDate)return!1;const l=e.deadline?new Date(e.deadline):null,t=e.reminderDate?new Date(e.reminderDate):null,a=l?Math.ceil((l.getTime()-n.getTime())/864e5):1/0,r=t?Math.ceil((t.getTime()-n.getTime())/864e5):1/0;return(a>=0&&a<=7||r>=0&&r<=7)&&e.stage!==b.CLOSED_WON&&e.stage!==b.CLOSED_LOST}).length},[]);(0,a.useEffect)(()=>{const e=H(n);z(e)},[n,H]);const B=e=>{R(e),w(!0)},U=e=>{if("number"===typeof e){const l=n.find(n=>n.id===e);l&&console.log("Xem chi ti\u1ebft deal:",l)}else console.log("Xem chi ti\u1ebft deal:",e)},Q=()=>{V("")};return(0,I.jsxs)(r.A,{sx:{p:3},children:[(0,I.jsxs)(r.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,I.jsx)(s.A,{variant:"h4",component:"h1",children:e("pages.deals.title")}),(0,I.jsx)(i.A,{variant:"contained",color:"primary",startIcon:(0,I.jsx)(j.A,{}),onClick:()=>{R(null),w(!0)},children:e("pages.deals.ui.addDeal")})]}),(0,I.jsx)(r.A,{sx:{mb:3},children:(0,I.jsx)(Te,{deals:n})}),(0,I.jsxs)(o.A,{sx:{p:2,mb:3},children:[(0,I.jsxs)(r.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,I.jsxs)(s.A,{variant:"h6",component:"div",children:[(0,I.jsx)(p.A,{sx:{verticalAlign:"middle",mr:1}}),e("pages.deals.ui.filters")]}),(0,I.jsxs)(r.A,{sx:{display:"flex",gap:1},children:[(0,I.jsx)(i.A,{variant:"text",size:"small",onClick:()=>{C({searchTerm:"",stage:"T\u1ea5t c\u1ea3",owner:"T\u1ea5t c\u1ea3",dateRange:null,hasReminder:null,valueRange:{min:0,max:1e9}})},startIcon:(0,I.jsx)(p.A,{}),children:e("pages.deals.ui.resetFilters")}),(0,I.jsx)(i.A,{variant:"outlined",size:"small",startIcon:(0,I.jsx)(v.A,{}),onClick:()=>P(!0),children:e("pages.deals.ui.smartFilter")})]})]}),(0,I.jsx)(he,{onFilterChange:e=>{C(e)},initialFilters:y})]}),(0,I.jsx)(r.A,{sx:{borderBottom:1,borderColor:"divider",mb:2},children:(0,I.jsxs)(d.A,{value:W,onChange:(e,n)=>{L(n)},"aria-label":"deal tabs",children:[(0,I.jsx)(c.A,{label:e("pages.deals.ui.tabs.allDeals",{count:D.length})}),(0,I.jsx)(c.A,{label:(0,I.jsxs)(r.A,{sx:{display:"flex",alignItems:"center"},children:[(0,I.jsx)(h.A,{badgeContent:_,color:"error",overlap:"circular",sx:{mr:1},children:(0,I.jsx)(f.A,{})}),(0,I.jsx)(r.A,{component:"span",children:e("pages.deals.ui.tabs.reminders")})]})})]})}),G&&(0,I.jsxs)(r.A,{sx:{mb:2,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,I.jsxs)(r.A,{sx:{display:"flex",alignItems:"center"},children:[(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",children:e("pages.deals.ui.filtering")}),(0,I.jsx)(x.A,{label:G,onDelete:Q,color:"primary",variant:"outlined",size:"small",sx:{ml:1}})]}),(0,I.jsx)(i.A,{size:"small",onClick:Q,color:"inherit",children:e("pages.deals.ui.clearFilter")})]}),0===W?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(s.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:e("pages.deals.ui.foundMatching",{count:D.length})}),(0,I.jsx)(ee,{deals:D,onView:U,onEdit:B,onDelete:e=>{M(e),O(!0)},onDuplicate:e=>{const a=(0,t.A)((0,t.A)({},e),{},{id:Math.max(0,...n.map(e=>e.id))+1,name:"".concat(e.name," (B\u1ea3n sao)"),createdAt:(new Date).toISOString()});l(e=>[...e,a])}})]}):(0,I.jsx)(Le,{deals:n,onViewDeal:U,onEditDeal:e=>{const l=n.find(n=>n.id===e);l&&B(l)},onMarkComplete:e=>{l(n=>n.map(n=>n.id===e?(0,t.A)((0,t.A)({},n),{},{reminderCompleted:!0}):n))},onStageChange:(e,n)=>{l(l=>l.map(l=>l.id===e?(0,t.A)((0,t.A)({},l),{},{stage:n}):l))}}),(0,I.jsx)(ge,{open:T,onClose:()=>{w(!1),R(null)},onSubmit:e=>{if(S)l(n=>n.map(n=>n.id===S.id?(0,t.A)((0,t.A)((0,t.A)({},n),e),{},{id:S.id,createdAt:S.createdAt}):n));else{const a=(0,t.A)((0,t.A)({},e),{},{id:Math.max(0,...n.map(e=>e.id))+1,createdAt:(new Date).toISOString(),hasReminder:!!e.reminderDate});l(e=>[...e,a])}w(!1)},initialData:S||void 0,title:e(S?"pages.deals.ui.form.editTitle":"pages.deals.ui.form.createTitle")}),(0,I.jsx)(E,{open:F,onClose:()=>P(!1),onApplyFilter:e=>{V(e),console.log("\xc1p d\u1ee5ng b\u1ed9 l\u1ecdc th\xf4ng minh:",e)},currentFilter:G}),(0,I.jsxs)(m.A,{open:N,onClose:()=>O(!1),children:[(0,I.jsx)(u.A,{children:e("pages.deals.ui.dialogs.deleteConfirmTitle")}),(0,I.jsx)(A.A,{children:(0,I.jsx)(s.A,{children:e("pages.deals.ui.dialogs.deleteConfirmText")})}),(0,I.jsxs)(g.A,{children:[(0,I.jsx)(i.A,{onClick:()=>O(!1),children:e("common.cancel")}),(0,I.jsx)(i.A,{onClick:()=>{k&&(l(e=>e.filter(e=>e.id!==k)),O(!1),M(null))},color:"error",variant:"contained",children:e("common.delete")})]})]})]})}}}]);
//# sourceMappingURL=384.14951db1.chunk.js.map